var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{};function e(t,e,n,r){Object.defineProperty(t,e,{get:n,set:r,enumerable:!0,configurable:!0})}var n={},r={},o=t.parcelRequire767d;null==o&&((o=function(t){if(t in n)return n[t].exports;if(t in r){var e=r[t];delete r[t];var o={id:t,exports:{}};return n[t]=o,e.call(o.exports,o,o.exports),o.exports}var i=new Error("Cannot find module '"+t+"'");throw i.code="MODULE_NOT_FOUND",i}).register=function(t,e){r[t]=e},t.parcelRequire767d=o),o.register("cVm5l",(function(e,n){
/*! For license information please see lsplugin.user.js.LICENSE.txt */self,e.exports=(()=>{var r={227:(t,e,n)=>{var r=n(155);e.formatArgs=function(e){if(e[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+e[0]+(this.useColors?"%c ":" ")+"+"+t.exports.humanize(this.diff),!this.useColors)return;const n="color: "+this.color;e.splice(1,0,n,"color: inherit");let r=0,o=0;e[0].replace(/%[a-zA-Z%]/g,(t=>{"%%"!==t&&(r++,"%c"===t&&(o=r))})),e.splice(o,0,n)},e.save=function(t){try{t?e.storage.setItem("debug",t):e.storage.removeItem("debug")}catch(t){}},e.load=function(){let t;try{t=e.storage.getItem("debug")}catch(t){}return!t&&void 0!==r&&"env"in r&&(t=r.env.DEBUG),t},e.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type&&!window.process.__nwjs)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},e.storage=function(){try{return localStorage}catch(t){}}(),e.destroy=(()=>{let t=!1;return()=>{t||(t=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],e.log=console.debug||console.log||(()=>{}),t.exports=n(447)(e);const{formatters:o}=t.exports;o.j=function(t){try{return JSON.stringify(t)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}}},447:(t,e,n)=>{t.exports=function(t){function e(t){let n,o=null;function i(...t){if(!i.enabled)return;const r=i,o=Number(new Date),s=o-(n||o);r.diff=s,r.prev=n,r.curr=o,n=o,t[0]=e.coerce(t[0]),"string"!=typeof t[0]&&t.unshift("%O");let a=0;t[0]=t[0].replace(/%([a-zA-Z%])/g,((n,o)=>{if("%%"===n)return"%";a++;const i=e.formatters[o];if("function"==typeof i){const e=t[a];n=i.call(r,e),t.splice(a,1),a--}return n})),e.formatArgs.call(r,t),(r.log||e.log).apply(r,t)}return i.namespace=t,i.useColors=e.useColors(),i.color=e.selectColor(t),i.extend=r,i.destroy=e.destroy,Object.defineProperty(i,"enabled",{enumerable:!0,configurable:!1,get:()=>null===o?e.enabled(t):o,set:t=>{o=t}}),"function"==typeof e.init&&e.init(i),i}function r(t,n){const r=e(this.namespace+(void 0===n?":":n)+t);return r.log=this.log,r}function o(t){return t.toString().substring(2,t.toString().length-2).replace(/\.\*\?$/,"*")}return e.debug=e,e.default=e,e.coerce=function(t){return t instanceof Error?t.stack||t.message:t},e.disable=function(){const t=[...e.names.map(o),...e.skips.map(o).map((t=>"-"+t))].join(",");return e.enable(""),t},e.enable=function(t){let n;e.save(t),e.names=[],e.skips=[];const r=("string"==typeof t?t:"").split(/[\s,]+/),o=r.length;for(n=0;n<o;n++)r[n]&&("-"===(t=r[n].replace(/\*/g,".*?"))[0]?e.skips.push(new RegExp("^"+t.substr(1)+"$")):e.names.push(new RegExp("^"+t+"$")))},e.enabled=function(t){if("*"===t[t.length-1])return!0;let n,r;for(n=0,r=e.skips.length;n<r;n++)if(e.skips[n].test(t))return!1;for(n=0,r=e.names.length;n<r;n++)if(e.names[n].test(t))return!0;return!1},e.humanize=n(824),e.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(t).forEach((n=>{e[n]=t[n]})),e.names=[],e.skips=[],e.formatters={},e.selectColor=function(t){let n=0;for(let e=0;e<t.length;e++)n=(n<<5)-n+t.charCodeAt(e),n|=0;return e.colors[Math.abs(n)%e.colors.length]},e.enable(e.load()),e}},856:function(t){t.exports=function(){var t=Object.hasOwnProperty,e=Object.setPrototypeOf,n=Object.isFrozen,r=Object.getPrototypeOf,o=Object.getOwnPropertyDescriptor,i=Object.freeze,s=Object.seal,a=Object.create,c="undefined"!=typeof Reflect&&Reflect,l=c.apply,u=c.construct;l||(l=function(t,e,n){return t.apply(e,n)}),i||(i=function(t){return t}),s||(s=function(t){return t}),u||(u=function(t,e){return new(Function.prototype.bind.apply(t,[null].concat(function(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}(e))))});var h,f=A(Array.prototype.forEach),p=A(Array.prototype.pop),d=A(Array.prototype.push),g=A(String.prototype.toLowerCase),y=A(String.prototype.match),m=A(String.prototype.replace),b=A(String.prototype.indexOf),v=A(String.prototype.trim),w=A(RegExp.prototype.test),_=(h=TypeError,function(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++)e[n]=arguments[n];return u(h,e)});function A(t){return function(e){for(var n=arguments.length,r=Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return l(t,e,r)}}function E(t,r){e&&e(t,null);for(var o=r.length;o--;){var i=r[o];if("string"==typeof i){var s=g(i);s!==i&&(n(r)||(r[o]=s),i=s)}t[i]=!0}return t}function C(e){var n=a(null),r=void 0;for(r in e)l(t,e,[r])&&(n[r]=e[r]);return n}function S(t,e){for(;null!==t;){var n=o(t,e);if(n){if(n.get)return A(n.get);if("function"==typeof n.value)return A(n.value)}t=r(t)}return function(t){return console.warn("fallback value for",t),null}}var O=i(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),k=i(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),x=i(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),T=i(["animate","color-profile","cursor","discard","fedropshadow","feimage","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),R=i(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),B=i(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),L=i(["#text"]),I=i(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),j=i(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),N=i(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),U=i(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),F=s(/\{\{[\s\S]*|[\s\S]*\}\}/gm),M=s(/<%[\s\S]*|[\s\S]*%>/gm),P=s(/^data-[\-\w.\u00B7-\uFFFF]/),D=s(/^aria-[\-\w]+$/),z=s(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),$=s(/^(?:\w+script|data):/i),q=s(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),H="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};function V(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}var W=function(){return"undefined"==typeof window?null:window},G=function(t,e){if("object"!==(void 0===t?"undefined":H(t))||"function"!=typeof t.createPolicy)return null;var n=null,r="data-tt-policy-suffix";e.currentScript&&e.currentScript.hasAttribute(r)&&(n=e.currentScript.getAttribute(r));var o="dompurify"+(n?"#"+n:"");try{return t.createPolicy(o,{createHTML:function(t){return t}})}catch(t){return console.warn("TrustedTypes policy "+o+" could not be created."),null}};return function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:W(),n=function(e){return t(e)};if(n.version="2.3.1",n.removed=[],!e||!e.document||9!==e.document.nodeType)return n.isSupported=!1,n;var r=e.document,o=e.document,s=e.DocumentFragment,a=e.HTMLTemplateElement,c=e.Node,l=e.Element,u=e.NodeFilter,h=e.NamedNodeMap,A=void 0===h?e.NamedNodeMap||e.MozNamedAttrMap:h,J=e.Text,Y=e.Comment,K=e.DOMParser,Z=e.trustedTypes,X=l.prototype,Q=S(X,"cloneNode"),tt=S(X,"nextSibling"),et=S(X,"childNodes"),nt=S(X,"parentNode");if("function"==typeof a){var rt=o.createElement("template");rt.content&&rt.content.ownerDocument&&(o=rt.content.ownerDocument)}var ot=G(Z,r),it=ot&&Ft?ot.createHTML(""):"",st=o,at=st.implementation,ct=st.createNodeIterator,lt=st.createDocumentFragment,ut=st.getElementsByTagName,ht=r.importNode,ft={};try{ft=C(o).documentMode?o.documentMode:{}}catch(t){}var pt={};n.isSupported="function"==typeof nt&&at&&void 0!==at.createHTMLDocument&&9!==ft;var dt=F,gt=M,yt=P,mt=D,bt=$,vt=q,wt=z,_t=null,At=E({},[].concat(V(O),V(k),V(x),V(R),V(L))),Et=null,Ct=E({},[].concat(V(I),V(j),V(N),V(U))),St=null,Ot=null,kt=!0,xt=!0,Tt=!1,Rt=!1,Bt=!1,Lt=!1,It=!1,jt=!1,Nt=!1,Ut=!0,Ft=!1,Mt=!0,Pt=!0,Dt=!1,zt={},$t=null,qt=E({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),Ht=null,Vt=E({},["audio","video","img","source","image","track"]),Wt=null,Gt=E({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Jt="http://www.w3.org/1998/Math/MathML",Yt="http://www.w3.org/2000/svg",Kt="http://www.w3.org/1999/xhtml",Zt=Kt,Xt=!1,Qt=null,te=o.createElement("form"),ee=function(t){Qt&&Qt===t||(t&&"object"===(void 0===t?"undefined":H(t))||(t={}),t=C(t),_t="ALLOWED_TAGS"in t?E({},t.ALLOWED_TAGS):At,Et="ALLOWED_ATTR"in t?E({},t.ALLOWED_ATTR):Ct,Wt="ADD_URI_SAFE_ATTR"in t?E(C(Gt),t.ADD_URI_SAFE_ATTR):Gt,Ht="ADD_DATA_URI_TAGS"in t?E(C(Vt),t.ADD_DATA_URI_TAGS):Vt,$t="FORBID_CONTENTS"in t?E({},t.FORBID_CONTENTS):qt,St="FORBID_TAGS"in t?E({},t.FORBID_TAGS):{},Ot="FORBID_ATTR"in t?E({},t.FORBID_ATTR):{},zt="USE_PROFILES"in t&&t.USE_PROFILES,kt=!1!==t.ALLOW_ARIA_ATTR,xt=!1!==t.ALLOW_DATA_ATTR,Tt=t.ALLOW_UNKNOWN_PROTOCOLS||!1,Rt=t.SAFE_FOR_TEMPLATES||!1,Bt=t.WHOLE_DOCUMENT||!1,jt=t.RETURN_DOM||!1,Nt=t.RETURN_DOM_FRAGMENT||!1,Ut=!1!==t.RETURN_DOM_IMPORT,Ft=t.RETURN_TRUSTED_TYPE||!1,It=t.FORCE_BODY||!1,Mt=!1!==t.SANITIZE_DOM,Pt=!1!==t.KEEP_CONTENT,Dt=t.IN_PLACE||!1,wt=t.ALLOWED_URI_REGEXP||wt,Zt=t.NAMESPACE||Kt,Rt&&(xt=!1),Nt&&(jt=!0),zt&&(_t=E({},[].concat(V(L))),Et=[],!0===zt.html&&(E(_t,O),E(Et,I)),!0===zt.svg&&(E(_t,k),E(Et,j),E(Et,U)),!0===zt.svgFilters&&(E(_t,x),E(Et,j),E(Et,U)),!0===zt.mathMl&&(E(_t,R),E(Et,N),E(Et,U))),t.ADD_TAGS&&(_t===At&&(_t=C(_t)),E(_t,t.ADD_TAGS)),t.ADD_ATTR&&(Et===Ct&&(Et=C(Et)),E(Et,t.ADD_ATTR)),t.ADD_URI_SAFE_ATTR&&E(Wt,t.ADD_URI_SAFE_ATTR),t.FORBID_CONTENTS&&($t===qt&&($t=C($t)),E($t,t.FORBID_CONTENTS)),Pt&&(_t["#text"]=!0),Bt&&E(_t,["html","head","body"]),_t.table&&(E(_t,["tbody"]),delete St.tbody),i&&i(t),Qt=t)},ne=E({},["mi","mo","mn","ms","mtext"]),re=E({},["foreignobject","desc","title","annotation-xml"]),oe=E({},k);E(oe,x),E(oe,T);var ie=E({},R);E(ie,B);var se=function(t){var e=nt(t);e&&e.tagName||(e={namespaceURI:Kt,tagName:"template"});var n=g(t.tagName),r=g(e.tagName);if(t.namespaceURI===Yt)return e.namespaceURI===Kt?"svg"===n:e.namespaceURI===Jt?"svg"===n&&("annotation-xml"===r||ne[r]):Boolean(oe[n]);if(t.namespaceURI===Jt)return e.namespaceURI===Kt?"math"===n:e.namespaceURI===Yt?"math"===n&&re[r]:Boolean(ie[n]);if(t.namespaceURI===Kt){if(e.namespaceURI===Yt&&!re[r])return!1;if(e.namespaceURI===Jt&&!ne[r])return!1;var o=E({},["title","style","font","a","script"]);return!ie[n]&&(o[n]||!oe[n])}return!1},ae=function(t){d(n.removed,{element:t});try{t.parentNode.removeChild(t)}catch(e){try{t.outerHTML=it}catch(e){t.remove()}}},ce=function(t,e){try{d(n.removed,{attribute:e.getAttributeNode(t),from:e})}catch(t){d(n.removed,{attribute:null,from:e})}if(e.removeAttribute(t),"is"===t&&!Et[t])if(jt||Nt)try{ae(e)}catch(t){}else try{e.setAttribute(t,"")}catch(t){}},le=function(t){var e=void 0,n=void 0;if(It)t="<remove></remove>"+t;else{var r=y(t,/^[\r\n\t ]+/);n=r&&r[0]}var i=ot?ot.createHTML(t):t;if(Zt===Kt)try{e=(new K).parseFromString(i,"text/html")}catch(t){}if(!e||!e.documentElement){e=at.createDocument(Zt,"template",null);try{e.documentElement.innerHTML=Xt?"":i}catch(t){}}var s=e.body||e.documentElement;return t&&n&&s.insertBefore(o.createTextNode(n),s.childNodes[0]||null),Zt===Kt?ut.call(e,Bt?"html":"body")[0]:Bt?e.documentElement:s},ue=function(t){return ct.call(t.ownerDocument||t,t,u.SHOW_ELEMENT|u.SHOW_COMMENT|u.SHOW_TEXT,null,!1)},he=function(t){return!(t instanceof J||t instanceof Y||"string"==typeof t.nodeName&&"string"==typeof t.textContent&&"function"==typeof t.removeChild&&t.attributes instanceof A&&"function"==typeof t.removeAttribute&&"function"==typeof t.setAttribute&&"string"==typeof t.namespaceURI&&"function"==typeof t.insertBefore)},fe=function(t){return"object"===(void 0===c?"undefined":H(c))?t instanceof c:t&&"object"===(void 0===t?"undefined":H(t))&&"number"==typeof t.nodeType&&"string"==typeof t.nodeName},pe=function(t,e,r){pt[t]&&f(pt[t],(function(t){t.call(n,e,r,Qt)}))},de=function(t){var e=void 0;if(pe("beforeSanitizeElements",t,null),he(t))return ae(t),!0;if(y(t.nodeName,/[\u0080-\uFFFF]/))return ae(t),!0;var r=g(t.nodeName);if(pe("uponSanitizeElement",t,{tagName:r,allowedTags:_t}),!fe(t.firstElementChild)&&(!fe(t.content)||!fe(t.content.firstElementChild))&&w(/<[/\w]/g,t.innerHTML)&&w(/<[/\w]/g,t.textContent))return ae(t),!0;if("select"===r&&w(/<template/i,t.innerHTML))return ae(t),!0;if(!_t[r]||St[r]){if(Pt&&!$t[r]){var o=nt(t)||t.parentNode,i=et(t)||t.childNodes;if(i&&o)for(var s=i.length-1;s>=0;--s)o.insertBefore(Q(i[s],!0),tt(t))}return ae(t),!0}return t instanceof l&&!se(t)?(ae(t),!0):"noscript"!==r&&"noembed"!==r||!w(/<\/no(script|embed)/i,t.innerHTML)?(Rt&&3===t.nodeType&&(e=t.textContent,e=m(e,dt," "),e=m(e,gt," "),t.textContent!==e&&(d(n.removed,{element:t.cloneNode()}),t.textContent=e)),pe("afterSanitizeElements",t,null),!1):(ae(t),!0)},ge=function(t,e,n){if(Mt&&("id"===e||"name"===e)&&(n in o||n in te))return!1;if(xt&&!Ot[e]&&w(yt,e));else if(kt&&w(mt,e));else{if(!Et[e]||Ot[e])return!1;if(Wt[e]);else if(w(wt,m(n,vt,"")));else if("src"!==e&&"xlink:href"!==e&&"href"!==e||"script"===t||0!==b(n,"data:")||!Ht[t])if(Tt&&!w(bt,m(n,vt,"")));else if(n)return!1}return!0},ye=function(t){var e=void 0,r=void 0,o=void 0,i=void 0;pe("beforeSanitizeAttributes",t,null);var s=t.attributes;if(s){var a={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:Et};for(i=s.length;i--;){var c=e=s[i],l=c.name,u=c.namespaceURI;if(r=v(e.value),o=g(l),a.attrName=o,a.attrValue=r,a.keepAttr=!0,a.forceKeepAttr=void 0,pe("uponSanitizeAttribute",t,a),r=a.attrValue,!a.forceKeepAttr&&(ce(l,t),a.keepAttr))if(w(/\/>/i,r))ce(l,t);else{Rt&&(r=m(r,dt," "),r=m(r,gt," "));var h=t.nodeName.toLowerCase();if(ge(h,o,r))try{u?t.setAttributeNS(u,l,r):t.setAttribute(l,r),p(n.removed)}catch(t){}}}pe("afterSanitizeAttributes",t,null)}},me=function t(e){var n=void 0,r=ue(e);for(pe("beforeSanitizeShadowDOM",e,null);n=r.nextNode();)pe("uponSanitizeShadowNode",n,null),de(n)||(n.content instanceof s&&t(n.content),ye(n));pe("afterSanitizeShadowDOM",e,null)};return n.sanitize=function(t,o){var i=void 0,a=void 0,l=void 0,u=void 0,h=void 0;if((Xt=!t)&&(t="\x3c!--\x3e"),"string"!=typeof t&&!fe(t)){if("function"!=typeof t.toString)throw _("toString is not a function");if("string"!=typeof(t=t.toString()))throw _("dirty is not a string, aborting")}if(!n.isSupported){if("object"===H(e.toStaticHTML)||"function"==typeof e.toStaticHTML){if("string"==typeof t)return e.toStaticHTML(t);if(fe(t))return e.toStaticHTML(t.outerHTML)}return t}if(Lt||ee(o),n.removed=[],"string"==typeof t&&(Dt=!1),Dt);else if(t instanceof c)1===(a=(i=le("\x3c!----\x3e")).ownerDocument.importNode(t,!0)).nodeType&&"BODY"===a.nodeName||"HTML"===a.nodeName?i=a:i.appendChild(a);else{if(!jt&&!Rt&&!Bt&&-1===t.indexOf("<"))return ot&&Ft?ot.createHTML(t):t;if(!(i=le(t)))return jt?null:it}i&&It&&ae(i.firstChild);for(var f=ue(Dt?t:i);l=f.nextNode();)3===l.nodeType&&l===u||de(l)||(l.content instanceof s&&me(l.content),ye(l),u=l);if(u=null,Dt)return t;if(jt){if(Nt)for(h=lt.call(i.ownerDocument);i.firstChild;)h.appendChild(i.firstChild);else h=i;return Ut&&(h=ht.call(r,h,!0)),h}var p=Bt?i.outerHTML:i.innerHTML;return Rt&&(p=m(p,dt," "),p=m(p,gt," ")),ot&&Ft?ot.createHTML(p):p},n.setConfig=function(t){ee(t),Lt=!0},n.clearConfig=function(){Qt=null,Lt=!1},n.isValidAttribute=function(t,e,n){Qt||ee({});var r=g(t),o=g(e);return ge(r,o,n)},n.addHook=function(t,e){"function"==typeof e&&(pt[t]=pt[t]||[],d(pt[t],e))},n.removeHook=function(t){pt[t]&&p(pt[t])},n.removeHooks=function(t){pt[t]&&(pt[t]=[])},n.removeAllHooks=function(){pt={}},n}()}()},729:t=>{var e=Object.prototype.hasOwnProperty,n="~";function r(){}function o(t,e,n){this.fn=t,this.context=e,this.once=n||!1}function i(t,e,r,i,s){if("function"!=typeof r)throw new TypeError("The listener must be a function");var a=new o(r,i||t,s),c=n?n+e:e;return t._events[c]?t._events[c].fn?t._events[c]=[t._events[c],a]:t._events[c].push(a):(t._events[c]=a,t._eventsCount++),t}function s(t,e){0==--t._eventsCount?t._events=new r:delete t._events[e]}function a(){this._events=new r,this._eventsCount=0}Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(n=!1)),a.prototype.eventNames=function(){var t,r,o=[];if(0===this._eventsCount)return o;for(r in t=this._events)e.call(t,r)&&o.push(n?r.slice(1):r);return Object.getOwnPropertySymbols?o.concat(Object.getOwnPropertySymbols(t)):o},a.prototype.listeners=function(t){var e=n?n+t:t,r=this._events[e];if(!r)return[];if(r.fn)return[r.fn];for(var o=0,i=r.length,s=new Array(i);o<i;o++)s[o]=r[o].fn;return s},a.prototype.listenerCount=function(t){var e=n?n+t:t,r=this._events[e];return r?r.fn?1:r.length:0},a.prototype.emit=function(t,e,r,o,i,s){var a=n?n+t:t;if(!this._events[a])return!1;var c,l,u=this._events[a],h=arguments.length;if(u.fn){switch(u.once&&this.removeListener(t,u.fn,void 0,!0),h){case 1:return u.fn.call(u.context),!0;case 2:return u.fn.call(u.context,e),!0;case 3:return u.fn.call(u.context,e,r),!0;case 4:return u.fn.call(u.context,e,r,o),!0;case 5:return u.fn.call(u.context,e,r,o,i),!0;case 6:return u.fn.call(u.context,e,r,o,i,s),!0}for(l=1,c=new Array(h-1);l<h;l++)c[l-1]=arguments[l];u.fn.apply(u.context,c)}else{var f,p=u.length;for(l=0;l<p;l++)switch(u[l].once&&this.removeListener(t,u[l].fn,void 0,!0),h){case 1:u[l].fn.call(u[l].context);break;case 2:u[l].fn.call(u[l].context,e);break;case 3:u[l].fn.call(u[l].context,e,r);break;case 4:u[l].fn.call(u[l].context,e,r,o);break;default:if(!c)for(f=1,c=new Array(h-1);f<h;f++)c[f-1]=arguments[f];u[l].fn.apply(u[l].context,c)}}return!0},a.prototype.on=function(t,e,n){return i(this,t,e,n,!1)},a.prototype.once=function(t,e,n){return i(this,t,e,n,!0)},a.prototype.removeListener=function(t,e,r,o){var i=n?n+t:t;if(!this._events[i])return this;if(!e)return s(this,i),this;var a=this._events[i];if(a.fn)a.fn!==e||o&&!a.once||r&&a.context!==r||s(this,i);else{for(var c=0,l=[],u=a.length;c<u;c++)(a[c].fn!==e||o&&!a[c].once||r&&a[c].context!==r)&&l.push(a[c]);l.length?this._events[i]=1===l.length?l[0]:l:s(this,i)}return this},a.prototype.removeAllListeners=function(t){var e;return t?(e=n?n+t:t,this._events[e]&&s(this,e)):(this._events=new r,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,t.exports=a},717:t=>{"function"==typeof Object.create?t.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(t,e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}},824:t=>{var e=1e3,n=60*e,r=60*n,o=24*r;function i(t,e,n,r){var o=e>=1.5*n;return Math.round(t/n)+" "+r+(o?"s":"")}t.exports=function(t,s){s=s||{};var a,c,l=typeof t;if("string"===l&&t.length>0)return function(t){if(!((t=String(t)).length>100)){var i=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(t);if(i){var s=parseFloat(i[1]);switch((i[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*s;case"weeks":case"week":case"w":return 6048e5*s;case"days":case"day":case"d":return s*o;case"hours":case"hour":case"hrs":case"hr":case"h":return s*r;case"minutes":case"minute":case"mins":case"min":case"m":return s*n;case"seconds":case"second":case"secs":case"sec":case"s":return s*e;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return s;default:return}}}}(t);if("number"===l&&isFinite(t))return s.long?(a=t,(c=Math.abs(a))>=o?i(a,c,o,"day"):c>=r?i(a,c,r,"hour"):c>=n?i(a,c,n,"minute"):c>=e?i(a,c,e,"second"):a+" ms"):function(t){var i=Math.abs(t);return i>=o?Math.round(t/o)+"d":i>=r?Math.round(t/r)+"h":i>=n?Math.round(t/n)+"m":i>=e?Math.round(t/e)+"s":t+"ms"}(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))}},520:(t,e,n)=>{var r=n(155),o="win32"===r.platform,i=n(539);function s(t,e){for(var n=[],r=0;r<t.length;r++){var o=t[r];o&&"."!==o&&(".."===o?n.length&&".."!==n[n.length-1]?n.pop():e&&n.push(".."):n.push(o))}return n}function a(t){for(var e=t.length-1,n=0;n<=e&&!t[n];n++);for(var r=e;r>=0&&!t[r];r--);return 0===n&&r===e?t:n>r?[]:t.slice(n,r+1)}var c=/^([a-zA-Z]:|[\\\/]{2}[^\\\/]+[\\\/]+[^\\\/]+)?([\\\/])?([\s\S]*?)$/,l=/^([\s\S]*?)((?:\.{1,2}|[^\\\/]+?|)(\.[^.\/\\]*|))(?:[\\\/]*)$/,u={};function h(t){var e=c.exec(t),n=(e[1]||"")+(e[2]||""),r=e[3]||"",o=l.exec(r);return[n,o[1],o[2],o[3]]}function f(t){var e=c.exec(t),n=e[1]||"",r=!!n&&":"!==n[1];return{device:n,isUnc:r,isAbsolute:r||!!e[2],tail:e[3]}}function p(t){return"\\\\"+t.replace(/^[\\\/]+/,"").replace(/[\\\/]+/g,"\\")}u.resolve=function(){for(var t="",e="",n=!1,o=arguments.length-1;o>=-1;o--){var a;if(o>=0?a=arguments[o]:t?(a=r.env["="+t])&&a.substr(0,3).toLowerCase()===t.toLowerCase()+"\\"||(a=t+"\\"):a=r.cwd(),!i.isString(a))throw new TypeError("Arguments to path.resolve must be strings");if(a){var c=f(a),l=c.device,u=c.isUnc,h=c.isAbsolute,d=c.tail;if((!l||!t||l.toLowerCase()===t.toLowerCase())&&(t||(t=l),n||(e=d+"\\"+e,n=h),t&&n))break}}return u&&(t=p(t)),t+(n?"\\":"")+(e=s(e.split(/[\\\/]+/),!n).join("\\"))||"."},u.normalize=function(t){var e=f(t),n=e.device,r=e.isUnc,o=e.isAbsolute,i=e.tail,a=/[\\\/]$/.test(i);return(i=s(i.split(/[\\\/]+/),!o).join("\\"))||o||(i="."),i&&a&&(i+="\\"),r&&(n=p(n)),n+(o?"\\":"")+i},u.isAbsolute=function(t){return f(t).isAbsolute},u.join=function(){for(var t=[],e=0;e<arguments.length;e++){var n=arguments[e];if(!i.isString(n))throw new TypeError("Arguments to path.join must be strings");n&&t.push(n)}var r=t.join("\\");return/^[\\\/]{2}[^\\\/]/.test(t[0])||(r=r.replace(/^[\\\/]{2,}/,"\\")),u.normalize(r)},u.relative=function(t,e){t=u.resolve(t),e=u.resolve(e);for(var n=t.toLowerCase(),r=e.toLowerCase(),o=a(e.split("\\")),i=a(n.split("\\")),s=a(r.split("\\")),c=Math.min(i.length,s.length),l=c,h=0;h<c;h++)if(i[h]!==s[h]){l=h;break}if(0==l)return e;var f=[];for(h=l;h<i.length;h++)f.push("..");return(f=f.concat(o.slice(l))).join("\\")},u._makeLong=function(t){if(!i.isString(t))return t;if(!t)return"";var e=u.resolve(t);return/^[a-zA-Z]\:\\/.test(e)?"\\\\?\\"+e:/^\\\\[^?.]/.test(e)?"\\\\?\\UNC\\"+e.substring(2):t},u.dirname=function(t){var e=h(t),n=e[0],r=e[1];return n||r?(r&&(r=r.substr(0,r.length-1)),n+r):"."},u.basename=function(t,e){var n=h(t)[2];return e&&n.substr(-1*e.length)===e&&(n=n.substr(0,n.length-e.length)),n},u.extname=function(t){return h(t)[3]},u.format=function(t){if(!i.isObject(t))throw new TypeError("Parameter 'pathObject' must be an object, not "+typeof t);var e=t.root||"";if(!i.isString(e))throw new TypeError("'pathObject.root' must be a string or undefined, not "+typeof t.root);var n=t.dir,r=t.base||"";return n?n[n.length-1]===u.sep?n+r:n+u.sep+r:r},u.parse=function(t){if(!i.isString(t))throw new TypeError("Parameter 'pathString' must be a string, not "+typeof t);var e=h(t);if(!e||4!==e.length)throw new TypeError("Invalid path '"+t+"'");return{root:e[0],dir:e[0]+e[1].slice(0,-1),base:e[2],ext:e[3],name:e[2].slice(0,e[2].length-e[3].length)}},u.sep="\\",u.delimiter=";";var d=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,g={};function y(t){return d.exec(t).slice(1)}g.resolve=function(){for(var t="",e=!1,n=arguments.length-1;n>=-1&&!e;n--){var o=n>=0?arguments[n]:r.cwd();if(!i.isString(o))throw new TypeError("Arguments to path.resolve must be strings");o&&(t=o+"/"+t,e="/"===o[0])}return(e?"/":"")+(t=s(t.split("/"),!e).join("/"))||"."},g.normalize=function(t){var e=g.isAbsolute(t),n=t&&"/"===t[t.length-1];return(t=s(t.split("/"),!e).join("/"))||e||(t="."),t&&n&&(t+="/"),(e?"/":"")+t},g.isAbsolute=function(t){return"/"===t.charAt(0)},g.join=function(){for(var t="",e=0;e<arguments.length;e++){var n=arguments[e];if(!i.isString(n))throw new TypeError("Arguments to path.join must be strings");n&&(t+=t?"/"+n:n)}return g.normalize(t)},g.relative=function(t,e){t=g.resolve(t).substr(1),e=g.resolve(e).substr(1);for(var n=a(t.split("/")),r=a(e.split("/")),o=Math.min(n.length,r.length),i=o,s=0;s<o;s++)if(n[s]!==r[s]){i=s;break}var c=[];for(s=i;s<n.length;s++)c.push("..");return(c=c.concat(r.slice(i))).join("/")},g._makeLong=function(t){return t},g.dirname=function(t){var e=y(t),n=e[0],r=e[1];return n||r?(r&&(r=r.substr(0,r.length-1)),n+r):"."},g.basename=function(t,e){var n=y(t)[2];return e&&n.substr(-1*e.length)===e&&(n=n.substr(0,n.length-e.length)),n},g.extname=function(t){return y(t)[3]},g.format=function(t){if(!i.isObject(t))throw new TypeError("Parameter 'pathObject' must be an object, not "+typeof t);var e=t.root||"";if(!i.isString(e))throw new TypeError("'pathObject.root' must be a string or undefined, not "+typeof t.root);return(t.dir?t.dir+g.sep:"")+(t.base||"")},g.parse=function(t){if(!i.isString(t))throw new TypeError("Parameter 'pathString' must be a string, not "+typeof t);var e=y(t);if(!e||4!==e.length)throw new TypeError("Invalid path '"+t+"'");return e[1]=e[1]||"",e[2]=e[2]||"",e[3]=e[3]||"",{root:e[0],dir:e[0]+e[1].slice(0,-1),base:e[2],ext:e[3],name:e[2].slice(0,e[2].length-e[3].length)}},g.sep="/",g.delimiter=":",t.exports=o?u:g,t.exports.posix=g,t.exports.win32=u},155:t=>{var e,n,r=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function s(t){if(e===setTimeout)return setTimeout(t,0);if((e===o||!e)&&setTimeout)return e=setTimeout,setTimeout(t,0);try{return e(t,0)}catch(n){try{return e.call(null,t,0)}catch(n){return e.call(this,t,0)}}}!function(){try{e="function"==typeof setTimeout?setTimeout:o}catch(t){e=o}try{n="function"==typeof clearTimeout?clearTimeout:i}catch(t){n=i}}();var a,c=[],l=!1,u=-1;function h(){l&&a&&(l=!1,a.length?c=a.concat(c):u=-1,c.length&&f())}function f(){if(!l){var t=s(h);l=!0;for(var e=c.length;e;){for(a=c,c=[];++u<e;)a&&a[u].run();u=-1,e=c.length}a=null,l=!1,function(t){if(n===clearTimeout)return clearTimeout(t);if((n===i||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(t);try{n(t)}catch(e){try{return n.call(null,t)}catch(e){return n.call(this,t)}}}(t)}}function p(t,e){this.fun=t,this.array=e}function d(){}r.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];c.push(new p(t,e)),1!==c.length||l||s(f)},p.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=d,r.addListener=d,r.once=d,r.off=d,r.removeListener=d,r.removeAllListeners=d,r.emit=d,r.prependListener=d,r.prependOnceListener=d,r.listeners=function(t){return[]},r.binding=function(t){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(t){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},384:t=>{t.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},539:(t,e,n)=>{var r=n(155),o=/%[sdj%]/g;e.format=function(t){if(!m(t)){for(var e=[],n=0;n<arguments.length;n++)e.push(a(arguments[n]));return e.join(" ")}n=1;for(var r=arguments,i=r.length,s=String(t).replace(o,(function(t){if("%%"===t)return"%";if(n>=i)return t;switch(t){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(t){return"[Circular]"}default:return t}})),c=r[n];n<i;c=r[++n])g(c)||!w(c)?s+=" "+c:s+=" "+a(c);return s},e.deprecate=function(t,o){if(b(n.g.process))return function(){return e.deprecate(t,o).apply(this,arguments)};if(!0===r.noDeprecation)return t;var i=!1;return function(){if(!i){if(r.throwDeprecation)throw new Error(o);r.traceDeprecation?console.trace(o):console.error(o),i=!0}return t.apply(this,arguments)}};var i,s={};function a(t,n){var r={seen:[],stylize:l};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),d(n)?r.showHidden=n:n&&e._extend(r,n),b(r.showHidden)&&(r.showHidden=!1),b(r.depth)&&(r.depth=2),b(r.colors)&&(r.colors=!1),b(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=c),u(r,t,r.depth)}function c(t,e){var n=a.styles[e];return n?"["+a.colors[n][0]+"m"+t+"["+a.colors[n][1]+"m":t}function l(t,e){return t}function u(t,n,r){if(t.customInspect&&n&&E(n.inspect)&&n.inspect!==e.inspect&&(!n.constructor||n.constructor.prototype!==n)){var o=n.inspect(r,t);return m(o)||(o=u(t,o,r)),o}var i=function(t,e){if(b(e))return t.stylize("undefined","undefined");if(m(e)){var n="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(n,"string")}return y(e)?t.stylize(""+e,"number"):d(e)?t.stylize(""+e,"boolean"):g(e)?t.stylize("null","null"):void 0}(t,n);if(i)return i;var s=Object.keys(n),a=function(t){var e={};return t.forEach((function(t,n){e[t]=!0})),e}(s);if(t.showHidden&&(s=Object.getOwnPropertyNames(n)),A(n)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return h(n);if(0===s.length){if(E(n)){var c=n.name?": "+n.name:"";return t.stylize("[Function"+c+"]","special")}if(v(n))return t.stylize(RegExp.prototype.toString.call(n),"regexp");if(_(n))return t.stylize(Date.prototype.toString.call(n),"date");if(A(n))return h(n)}var l,w="",C=!1,S=["{","}"];return p(n)&&(C=!0,S=["[","]"]),E(n)&&(w=" [Function"+(n.name?": "+n.name:"")+"]"),v(n)&&(w=" "+RegExp.prototype.toString.call(n)),_(n)&&(w=" "+Date.prototype.toUTCString.call(n)),A(n)&&(w=" "+h(n)),0!==s.length||C&&0!=n.length?r<0?v(n)?t.stylize(RegExp.prototype.toString.call(n),"regexp"):t.stylize("[Object]","special"):(t.seen.push(n),l=C?function(t,e,n,r,o){for(var i=[],s=0,a=e.length;s<a;++s)x(e,String(s))?i.push(f(t,e,n,r,String(s),!0)):i.push("");return o.forEach((function(o){o.match(/^\d+$/)||i.push(f(t,e,n,r,o,!0))})),i}(t,n,r,a,s):s.map((function(e){return f(t,n,r,a,e,C)})),t.seen.pop(),function(t,e,n){return t.reduce((function(t,e){return e.indexOf("\n"),t+e.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60?n[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+n[1]:n[0]+e+" "+t.join(", ")+" "+n[1]}(l,w,S)):S[0]+w+S[1]}function h(t){return"["+Error.prototype.toString.call(t)+"]"}function f(t,e,n,r,o,i){var s,a,c;if((c=Object.getOwnPropertyDescriptor(e,o)||{value:e[o]}).get?a=c.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):c.set&&(a=t.stylize("[Setter]","special")),x(r,o)||(s="["+o+"]"),a||(t.seen.indexOf(c.value)<0?(a=g(n)?u(t,c.value,null):u(t,c.value,n-1)).indexOf("\n")>-1&&(a=i?a.split("\n").map((function(t){return"  "+t})).join("\n").substr(2):"\n"+a.split("\n").map((function(t){return"   "+t})).join("\n")):a=t.stylize("[Circular]","special")),b(s)){if(i&&o.match(/^\d+$/))return a;(s=JSON.stringify(""+o)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=t.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=t.stylize(s,"string"))}return s+": "+a}function p(t){return Array.isArray(t)}function d(t){return"boolean"==typeof t}function g(t){return null===t}function y(t){return"number"==typeof t}function m(t){return"string"==typeof t}function b(t){return void 0===t}function v(t){return w(t)&&"[object RegExp]"===C(t)}function w(t){return"object"==typeof t&&null!==t}function _(t){return w(t)&&"[object Date]"===C(t)}function A(t){return w(t)&&("[object Error]"===C(t)||t instanceof Error)}function E(t){return"function"==typeof t}function C(t){return Object.prototype.toString.call(t)}function S(t){return t<10?"0"+t.toString(10):t.toString(10)}e.debuglog=function(t){if(b(i)&&(i=r.env.NODE_DEBUG||""),t=t.toUpperCase(),!s[t])if(new RegExp("\\b"+t+"\\b","i").test(i)){var n=r.pid;s[t]=function(){var r=e.format.apply(e,arguments);console.error("%s %d: %s",t,n,r)}}else s[t]=function(){};return s[t]},e.inspect=a,a.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},a.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},e.isArray=p,e.isBoolean=d,e.isNull=g,e.isNullOrUndefined=function(t){return null==t},e.isNumber=y,e.isString=m,e.isSymbol=function(t){return"symbol"==typeof t},e.isUndefined=b,e.isRegExp=v,e.isObject=w,e.isDate=_,e.isError=A,e.isFunction=E,e.isPrimitive=function(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||void 0===t},e.isBuffer=n(384);var O=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function k(){var t=new Date,e=[S(t.getHours()),S(t.getMinutes()),S(t.getSeconds())].join(":");return[t.getDate(),O[t.getMonth()],e].join(" ")}function x(t,e){return Object.prototype.hasOwnProperty.call(t,e)}e.log=function(){console.log("%s - %s",k(),e.format.apply(e,arguments))},e.inherits=n(717),e._extend=function(t,e){if(!e||!w(e))return t;for(var n=Object.keys(e),r=n.length;r--;)t[n[r]]=e[n[r]];return t}}},o={};function i(t){var e=o[t];if(void 0!==e)return e.exports;var n=o[t]={exports:{}};return r[t].call(n.exports,n,n.exports,i),n.exports}i.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return i.d(e,{a:e}),e},i.d=(t,e)=>{for(var n in e)i.o(e,n)&&!i.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),i.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var s={};return(()=>{i.r(s),i.d(s,{LSPluginUser:()=>Me,setupPluginUserInstance:()=>Pe});var r=i(520);i(856);const o=function(t,e){return t===e||t!=t&&e!=e},a=function(t,e){for(var n=t.length;n--;)if(o(t[n][0],e))return n;return-1};var c=Array.prototype.splice;function l(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}l.prototype.clear=function(){this.__data__=[],this.size=0},l.prototype.delete=function(t){var e=this.__data__,n=a(e,t);return!(n<0||(n==e.length-1?e.pop():c.call(e,n,1),--this.size,0))},l.prototype.get=function(t){var e=this.__data__,n=a(e,t);return n<0?void 0:e[n][1]},l.prototype.has=function(t){return a(this.__data__,t)>-1},l.prototype.set=function(t,e){var n=this.__data__,r=a(n,t);return r<0?(++this.size,n.push([t,e])):n[r][1]=e,this};const u=l,h="object"==typeof t&&t&&t.Object===Object&&t;var f="object"==typeof self&&self&&self.Object===Object&&self;const p=h||f||Function("return this")(),d=p.Symbol;var g=Object.prototype,y=g.hasOwnProperty,m=g.toString,b=d?d.toStringTag:void 0,v=Object.prototype.toString,w=d?d.toStringTag:void 0;const _=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":w&&w in Object(t)?function(t){var e=y.call(t,b),n=t[b];try{t[b]=void 0;var r=!0}catch(t){}var o=m.call(t);return r&&(e?t[b]=n:delete t[b]),o}(t):function(t){return v.call(t)}(t)},A=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)},E=function(t){if(!A(t))return!1;var e=_(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e},C=p["__core-js_shared__"];var S,O=(S=/[^.]+$/.exec(C&&C.keys&&C.keys.IE_PROTO||""))?"Symbol(src)_1."+S:"",k=Function.prototype.toString,x=/^\[object .+?Constructor\]$/,T=Function.prototype,R=Object.prototype,B=T.toString,L=R.hasOwnProperty,I=RegExp("^"+B.call(L).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");const j=function(t){var e;return!(!A(t)||(e=t,O&&O in e))&&(E(t)?I:x).test(function(t){if(null!=t){try{return k.call(t)}catch(t){}try{return t+""}catch(t){}}return""}(t))},N=function(t,e){var n=function(t,e){return null==t?void 0:t[e]}(t,e);return j(n)?n:void 0},U=N(p,"Map"),F=N(Object,"create");var M=Object.prototype.hasOwnProperty,P=Object.prototype.hasOwnProperty;function D(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}D.prototype.clear=function(){this.__data__=F?F(null):{},this.size=0},D.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},D.prototype.get=function(t){var e=this.__data__;if(F){var n=e[t];return"__lodash_hash_undefined__"===n?void 0:n}return M.call(e,t)?e[t]:void 0},D.prototype.has=function(t){var e=this.__data__;return F?void 0!==e[t]:P.call(e,t)},D.prototype.set=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=F&&void 0===e?"__lodash_hash_undefined__":e,this};const z=D,$=function(t,e){var n,r,o=t.__data__;return("string"==(r=typeof(n=e))||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==n:null===n)?o["string"==typeof e?"string":"hash"]:o.map};function q(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}q.prototype.clear=function(){this.size=0,this.__data__={hash:new z,map:new(U||u),string:new z}},q.prototype.delete=function(t){var e=$(this,t).delete(t);return this.size-=e?1:0,e},q.prototype.get=function(t){return $(this,t).get(t)},q.prototype.has=function(t){return $(this,t).has(t)},q.prototype.set=function(t,e){var n=$(this,t),r=n.size;return n.set(t,e),this.size+=n.size==r?0:1,this};const H=q;function V(t){var e=this.__data__=new u(t);this.size=e.size}V.prototype.clear=function(){this.__data__=new u,this.size=0},V.prototype.delete=function(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n},V.prototype.get=function(t){return this.__data__.get(t)},V.prototype.has=function(t){return this.__data__.has(t)},V.prototype.set=function(t,e){var n=this.__data__;if(n instanceof u){var r=n.__data__;if(!U||r.length<199)return r.push([t,e]),this.size=++n.size,this;n=this.__data__=new H(r)}return n.set(t,e),this.size=n.size,this};const W=V,G=function(){try{var t=N(Object,"defineProperty");return t({},"",{}),t}catch(t){}}(),J=function(t,e,n){"__proto__"==e&&G?G(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n},Y=function(t,e,n){(void 0!==n&&!o(t[e],n)||void 0===n&&!(e in t))&&J(t,e,n)},K=function(t,e,n){for(var r=-1,o=Object(t),i=n(t),s=i.length;s--;){var a=i[++r];if(!1===e(o[a],a,o))break}return t};var Z=n&&!n.nodeType&&n,X=Z&&e&&!e.nodeType&&e,Q=X&&X.exports===Z?p.Buffer:void 0;Q&&Q.allocUnsafe;const tt=p.Uint8Array,et=function(t,e){var n,r,o=e?(r=new(n=t.buffer).constructor(n.byteLength),new tt(r).set(new tt(n)),r):t.buffer;return new t.constructor(o,t.byteOffset,t.length)};var nt=Object.create;const rt=function(){function t(){}return function(e){if(!A(e))return{};if(nt)return nt(e);t.prototype=e;var n=new t;return t.prototype=void 0,n}}(),ot=(it=Object.getPrototypeOf,st=Object,function(t){return it(st(t))});var it,st,at=Object.prototype;const ct=function(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||at)},lt=function(t){return null!=t&&"object"==typeof t},ut=function(t){return lt(t)&&"[object Arguments]"==_(t)};var ht=Object.prototype,ft=ht.hasOwnProperty,pt=ht.propertyIsEnumerable;const dt=ut(function(){return arguments}())?ut:function(t){return lt(t)&&ft.call(t,"callee")&&!pt.call(t,"callee")},gt=Array.isArray,yt=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991},mt=function(t){return null!=t&&yt(t.length)&&!E(t)};var bt=n&&!n.nodeType&&n,vt=bt&&e&&!e.nodeType&&e,wt=vt&&vt.exports===bt?p.Buffer:void 0;const _t=(wt?wt.isBuffer:void 0)||function(){return!1};var At=Function.prototype,Et=Object.prototype,Ct=At.toString,St=Et.hasOwnProperty,Ot=Ct.call(Object),kt={};kt["[object Float32Array]"]=kt["[object Float64Array]"]=kt["[object Int8Array]"]=kt["[object Int16Array]"]=kt["[object Int32Array]"]=kt["[object Uint8Array]"]=kt["[object Uint8ClampedArray]"]=kt["[object Uint16Array]"]=kt["[object Uint32Array]"]=!0,kt["[object Arguments]"]=kt["[object Array]"]=kt["[object ArrayBuffer]"]=kt["[object Boolean]"]=kt["[object DataView]"]=kt["[object Date]"]=kt["[object Error]"]=kt["[object Function]"]=kt["[object Map]"]=kt["[object Number]"]=kt["[object Object]"]=kt["[object RegExp]"]=kt["[object Set]"]=kt["[object String]"]=kt["[object WeakMap]"]=!1;var xt=n&&!n.nodeType&&n,Tt=xt&&e&&!e.nodeType&&e,Rt=Tt&&Tt.exports===xt&&h.process,Bt=function(){try{return Tt&&Tt.require&&Tt.require("util").types||Rt&&Rt.binding&&Rt.binding("util")}catch(t){}}(),Lt=Bt&&Bt.isTypedArray;const It=Lt?function(t){return function(e){return t(e)}}(Lt):function(t){return lt(t)&&yt(t.length)&&!!kt[_(t)]},jt=function(t,e){if(("constructor"!==e||"function"!=typeof t[e])&&"__proto__"!=e)return t[e]};var Nt=Object.prototype.hasOwnProperty;const Ut=function(t,e,n){var r=t[e];Nt.call(t,e)&&o(r,n)&&(void 0!==n||e in t)||J(t,e,n)};var Ft=/^(?:0|[1-9]\d*)$/;const Mt=function(t,e){var n=typeof t;return!!(e=null==e?9007199254740991:e)&&("number"==n||"symbol"!=n&&Ft.test(t))&&t>-1&&t%1==0&&t<e};var Pt=Object.prototype.hasOwnProperty;const Dt=function(t,e){var n=gt(t),r=!n&&dt(t),o=!n&&!r&&_t(t),i=!n&&!r&&!o&&It(t),s=n||r||o||i,a=s?function(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}(t.length,String):[],c=a.length;for(var l in t)!e&&!Pt.call(t,l)||s&&("length"==l||o&&("offset"==l||"parent"==l)||i&&("buffer"==l||"byteLength"==l||"byteOffset"==l)||Mt(l,c))||a.push(l);return a};var zt=Object.prototype.hasOwnProperty;const $t=function(t){if(!A(t))return function(t){var e=[];if(null!=t)for(var n in Object(t))e.push(n);return e}(t);var e=ct(t),n=[];for(var r in t)("constructor"!=r||!e&&zt.call(t,r))&&n.push(r);return n},qt=function(t){return mt(t)?Dt(t,!0):$t(t)},Ht=function(t){return function(t,e,n,r){var o=!n;n||(n={});for(var i=-1,s=e.length;++i<s;){var a=e[i],c=r?r(n[a],t[a],a,n,t):void 0;void 0===c&&(c=t[a]),o?J(n,a,c):Ut(n,a,c)}return n}(t,qt(t))},Vt=function(t,e,n,r,o,i,s){var a,c=jt(t,n),l=jt(e,n),u=s.get(l);if(u)Y(t,n,u);else{var h=i?i(c,l,n+"",t,e,s):void 0,f=void 0===h;if(f){var p=gt(l),d=!p&&_t(l),g=!p&&!d&&It(l);h=l,p||d||g?gt(c)?h=c:lt(a=c)&&mt(a)?h=function(t,e){var n=-1,r=t.length;for(e||(e=Array(r));++n<r;)e[n]=t[n];return e}(c):d?(f=!1,h=function(t,e){return t.slice()}(l)):g?(f=!1,h=et(l,!0)):h=[]:function(t){if(!lt(t)||"[object Object]"!=_(t))return!1;var e=ot(t);if(null===e)return!0;var n=St.call(e,"constructor")&&e.constructor;return"function"==typeof n&&n instanceof n&&Ct.call(n)==Ot}(l)||dt(l)?(h=c,dt(c)?h=Ht(c):A(c)&&!E(c)||(h=function(t){return"function"!=typeof t.constructor||ct(t)?{}:rt(ot(t))}(l))):f=!1}f&&(s.set(l,h),o(h,l,r,i,s),s.delete(l)),Y(t,n,h)}},Wt=function t(e,n,r,o,i){e!==n&&K(n,(function(s,a){if(i||(i=new W),A(s))Vt(e,n,a,r,t,o,i);else{var c=o?o(jt(e,a),s,a+"",e,n,i):void 0;void 0===c&&(c=s),Y(e,a,c)}}),qt)},Gt=function(t){return t},Jt=function(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)};var Yt=Math.max;const Kt=G?function(t,e){var n;return G(t,"toString",{configurable:!0,enumerable:!1,value:(n=e,function(){return n}),writable:!0})}:Gt;var Zt=Date.now;const Xt=function(t){var e=0,n=0;return function(){var r=Zt(),o=16-(r-n);if(n=r,o>0){if(++e>=800)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}(Kt),Qt=(ee=function(t,e,n){Wt(t,e,n)},function(t,e){return Xt(function(t,e,n){return e=Yt(void 0===e?t.length-1:e,0),function(){for(var r=arguments,o=-1,i=Yt(r.length-e,0),s=Array(i);++o<i;)s[o]=r[e+o];o=-1;for(var a=Array(e+1);++o<e;)a[o]=r[o];return a[e]=n(s),Jt(t,this,a)}}(t,void 0,Gt),t+"")}((function(t,e){var n=-1,r=e.length,i=r>1?e[r-1]:void 0,s=r>2?e[2]:void 0;for(i=ee.length>3&&"function"==typeof i?(r--,i):void 0,s&&function(t,e,n){if(!A(n))return!1;var r=typeof e;return!!("number"==r?mt(n)&&Mt(e,n.length):"string"==r&&e in n)&&o(n[e],t)}(e[0],e[1],s)&&(i=r<3?void 0:i,r=1),t=Object(t);++n<r;){var a=e[n];a&&ee(t,a,n)}return t}))),te="win32"===navigator.platform.toLowerCase()?r.win32:r.posix;var ee;const ne=Qt;function re(t,e){let n,r,o=!1;const i=e=>n=>{t&&clearTimeout(t),e(n),o=!0},s=new Promise(((o,s)=>{n=i(o),r=i(s),t&&(t=setTimeout((()=>r(new Error(`[deferred timeout] ${e}`))),t))}));return{created:Date.now(),setTag:t=>e=t,resolve:n,reject:r,promise:s,get settled(){return o}}}new Map;var oe=i(227),ie=i.n(oe);const se="application/x-postmate-v1+json";let ae=0;const ce={handshake:1,"handshake-reply":1,call:1,emit:1,reply:1,request:1},le=(t,e)=>!("string"==typeof e&&t.origin!==e||!t.data||"object"==typeof t.data&&!("postmate"in t.data)||t.data.type!==se||!ce[t.data.postmate]);class ue{parent;frame;child;events={};childOrigin;listener;constructor(t){this.parent=t.parent,this.frame=t.frame,this.child=t.child,this.childOrigin=t.childOrigin,this.listener=t=>{if(!le(t,this.childOrigin))return!1;const{data:e,name:n}=((t||{}).data||{}).value||{};"emit"===t.data.postmate&&n in this.events&&this.events[n].forEach((t=>{t.call(this,e)}))},this.parent.addEventListener("message",this.listener,!1)}get(t){return new Promise((e=>{const n=++ae,r=t=>{t.data.uid===n&&"reply"===t.data.postmate&&(this.parent.removeEventListener("message",r,!1),e(t.data.value))};this.parent.addEventListener("message",r,!1),this.child.postMessage({postmate:"request",type:se,property:t,uid:n},this.childOrigin)}))}call(t,e){this.child.postMessage({postmate:"call",type:se,property:t,data:e},this.childOrigin)}on(t,e){this.events[t]||(this.events[t]=[]),this.events[t].push(e)}destroy(){window.removeEventListener("message",this.listener,!1),this.frame.parentNode.removeChild(this.frame)}}class he{model;parent;parentOrigin;child;constructor(t){this.model=t.model,this.parent=t.parent,this.parentOrigin=t.parentOrigin,this.child=t.child,this.child.addEventListener("message",(t=>{if(!le(t,this.parentOrigin))return;const{property:e,uid:n,data:r}=t.data;"call"!==t.data.postmate?((t,e)=>{const n="function"==typeof t[e]?t[e]():t[e];return Promise.resolve(n)})(this.model,e).then((r=>{t.source.postMessage({property:e,postmate:"reply",type:se,uid:n,value:r},t.origin)})):e in this.model&&"function"==typeof this.model[e]&&this.model[e](r)}))}emit(t,e){this.parent.postMessage({postmate:"emit",type:se,value:{name:t,data:e}},this.parentOrigin)}}class fe{static debug=!1;container;parent;frame;child;childOrigin;url;model;static Model;constructor(t){this.container=t.container,this.url=t.url,this.parent=window,this.frame=document.createElement("iframe"),t.id&&(this.frame.id=t.id),t.name&&(this.frame.name=t.name),this.frame.classList.add.apply(this.frame.classList,t.classListArray||[]),this.container.appendChild(this.frame),this.child=this.frame.contentWindow,this.model=t.model||{}}sendHandshake(t){const e=(t=>{const e=document.createElement("a");e.href=t;const n=e.protocol.length>4?e.protocol:window.location.protocol,r=e.host.length?"80"===e.port||"443"===e.port?e.hostname:e.host:window.location.host;return e.origin||`${n}//${r}`})(t=t||this.url);let n,r=0;return new Promise(((o,i)=>{const s=t=>!!le(t,e)&&("handshake-reply"===t.data.postmate?(clearInterval(n),this.parent.removeEventListener("message",s,!1),this.childOrigin=t.origin,o(new ue(this))):i("Failed handshake"));this.parent.addEventListener("message",s,!1);const a=()=>{r++,this.child.postMessage({postmate:"handshake",type:se,model:this.model},e),5===r&&clearInterval(n)};this.frame.addEventListener("load",(()=>{a(),n=setInterval(a,500)})),this.frame.src=t}))}}class pe{child;model;parent;parentOrigin;constructor(t){this.child=window,this.model=t,this.parent=this.child.parent}sendHandshakeReply(){return new Promise(((t,e)=>{const n=r=>{if(r.data.postmate){if("handshake"===r.data.postmate){this.child.removeEventListener("message",n,!1),r.source.postMessage({postmate:"handshake-reply",type:se},r.origin),this.parentOrigin=r.origin;const e=r.data.model;return e&&Object.keys(e).forEach((t=>{this.model[t]=e[t]})),t(new he(this))}return e("Handshake Reply Failed")}};this.child.addEventListener("message",n,!1)}))}}var de=i(729),ge=i.n(de);const{importHTML:ye,createSandboxContainer:me}=window.QSandbox||{};function be(t,e){return t.startsWith("http")?fetch(t,e):(t=t.replace("file://",""),new Promise((async(e,n)=>{try{const n=await window.apis.doAction(["readFile",t]);e({text:()=>n})}catch(t){console.error(t),n(t)}})))}class ve extends(ge()){_pluginLocal;_frame;_root;_loaded=!1;_unmountFns=[];constructor(t){super(),this._pluginLocal=t,t._dispose((()=>{this._unmount()}))}async load(){const{name:t,entry:e}=this._pluginLocal.options;if(this.loaded||!e)return;const{template:n,execScripts:r}=await ye(e,{fetch:be});this._mount(n,document.body);const o=me(t,{elementGetter:()=>this._root?.firstChild}).instance.proxy;o.__shadow_mode__=!0,o.LSPluginLocal=this._pluginLocal,o.LSPluginShadow=this,o.LSPluginUser=o.logseq=new Me(this._pluginLocal.toJSON(),this._pluginLocal.caller);const i=await r(o,!0);this._unmountFns.push(i.unmount),this._loaded=!0}_mount(t,e){const n=this._frame=document.createElement("div");n.classList.add("lsp-shadow-sandbox"),n.id=this._pluginLocal.id,this._root=n.attachShadow({mode:"open"}),this._root.innerHTML=`<div>${t}</div>`,e.appendChild(n),this.emit("mounted")}_unmount(){for(const t of this._unmountFns)t&&t.call(null)}destroy(){this.frame?.parentNode?.removeChild(this.frame)}get loaded(){return this._loaded}get document(){return this._root?.firstChild}get frame(){return this._frame}}const we=ie()("LSPlugin:caller"),_e="#await#response#",Ae="#lspmsg#error#",Ee=t=>`#lspmsg#${t}`;class Ce extends(ge()){_pluginLocal;_connected=!1;_parent;_child;_shadow;_status;_userModel={};_call;_callUserModel;_debugTag="";constructor(t){super(),this._pluginLocal=t,t&&(this._debugTag=t.debugTag)}async connectToChild(){if(this._connected)return;const{shadow:t}=this._pluginLocal;t?await this._setupShadowSandbox():await this._setupIframeSandbox()}async connectToParent(t={}){if(this._connected)return;const e=this,n=null!=this._pluginLocal;let r=0,o=0;const i=new Map,s=re(5e3),a=this._extendUserModel({"#lspmsg#ready#":async t=>{a[Ee(t?.pid)]=({type:t,payload:n})=>{we(`[call from host (_call)] ${this._debugTag}`,t,n),e.emit(t,n)},await s.resolve()},"#lspmsg#beforeunload#":async t=>{const n=re(1e4);e.emit("beforeunload",Object.assign({actor:n},t)),await n.promise},"#lspmsg#settings#":async({type:t,payload:n})=>{e.emit("settings:changed",n)},"#lspmsg#":async({ns:t,type:n,payload:r})=>{we(`[call from host (async)] ${this._debugTag}`,t,n,r),t&&t.startsWith("hook")?e.emit(`${t}:${n}`,r):e.emit(n,r)},"#lspmsg#reply#":({_sync:t,result:e})=>{if(we(`[sync reply] #${t}`,e),i.has(t)){const n=i.get(t);n&&(e?.hasOwnProperty(Ae)?n.reject(e[Ae]):n.resolve(e),i.delete(t))}},...t});if(n)return await s.promise,JSON.parse(JSON.stringify(this._pluginLocal?.toJSON()));const c=new pe(a).sendHandshakeReply();return this._status="pending",await c.then((t=>{this._child=t,this._connected=!0,this._call=async(e,n={},r)=>{if(r){const t=++o;i.set(t,r),n._sync=t,r.setTag(`async call #${t}`),we("async call #",t)}return t.emit(Ee(a.baseInfo.id),{type:e,payload:n}),r?.promise},this._callUserModel=async(t,e)=>{try{a[t](e)}catch(e){we(`[model method] #${t} not existed`)}},r=setInterval((()=>{if(i.size>100)for(const[t,e]of i)e.settled&&i.delete(t)}),18e5)})).finally((()=>{this._status=void 0})),await s.promise,a.baseInfo}async call(t,e={}){return this._call?.call(this,t,e)}async callAsync(t,e={}){const n=re(1e4);return this._call?.call(this,t,e,n)}async callUserModel(t,e={}){return this._callUserModel?.call(this,t,e)}async _setupIframeSandbox(){const t=this._pluginLocal,e=t.id,n=new URL(t.options.entry);n.searchParams.set("__v__",t.options.version);const r=document.querySelector(`#${e}`);r&&r.parentElement.removeChild(r);const o=document.createElement("div");o.classList.add("lsp-iframe-sandbox-container"),o.id=e;try{const t=(await this._pluginLocal._loadLayoutsData())?.$$0;if(t){o.dataset.inited_layout="true";const{width:e,height:n,left:r,top:i}=t;Object.assign(o.style,{width:e+"px",height:n+"px",left:r+"px",top:i+"px"})}}catch(t){console.error("[Restore Layout Error]",t)}document.body.appendChild(o);let i,s=new fe({id:e+"_iframe",container:o,url:n.href,classListArray:["lsp-iframe-sandbox"],model:{baseInfo:JSON.parse(JSON.stringify(t.toJSON()))}}).sendHandshake();return this._status="pending",new Promise(((e,n)=>{i=setTimeout((()=>{n(new Error("handshake Timeout"))}),3e3),s.then((n=>{this._parent=n,this._connected=!0,this.emit("connected"),n.on(Ee(t.id),(({type:t,payload:e})=>{we("[call from plugin] ",t,e),this._pluginLocal?.emit(t,e||{})})),this._call=async(...e)=>{await n.call(Ee(t.id),{type:e[0],payload:Object.assign(e[1]||{},{$$pid:t.id})})},this._callUserModel=async(t,e)=>{if(t.startsWith(_e))return await n.get(t.replace(_e,""));n.call(t,e)},e(null)})).catch((t=>{n(t)})).finally((()=>{clearTimeout(i)}))})).catch((t=>{throw we("[iframe sandbox] error",t),t})).finally((()=>{this._status=void 0}))}async _setupShadowSandbox(){const t=this._pluginLocal,e=this._shadow=new ve(t);try{this._status="pending",await e.load(),this._connected=!0,this.emit("connected"),this._call=async(e,n={},r)=>(r&&(n.actor=r),this._pluginLocal?.emit(e,Object.assign(n,{$$pid:t.id})),r?.promise),this._callUserModel=async(...t)=>{let e=t[0];e?.startsWith(_e)&&(e=e.replace(_e,""));const n=t[1]||{},r=this._userModel[e];"function"==typeof r&&await r.call(null,n)}}catch(t){throw we("[shadow sandbox] error",t),t}finally{this._status=void 0}}_extendUserModel(t){return Object.assign(this._userModel,t)}_getSandboxIframeContainer(){return this._parent?.frame.parentNode}_getSandboxShadowContainer(){return this._shadow?.frame.parentNode}_getSandboxIframeRoot(){return this._parent?.frame}_getSandboxShadowRoot(){return this._shadow?.frame}set debugTag(t){this._debugTag=t}async destroy(){let t=null;this._parent&&(t=this._getSandboxIframeContainer(),await this._parent.destroy()),this._shadow&&(t=this._getSandboxShadowContainer(),this._shadow.destroy()),t?.parentNode.removeChild(t)}}var Se=function(){return(Se=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};function Oe(t){return t.toLowerCase()}Object.create,Object.create;var ke=[/([a-z0-9])([A-Z])/g,/([A-Z])([A-Z][a-z])/g],xe=/[^A-Z0-9]+/gi;function Te(t,e,n){return e instanceof RegExp?t.replace(e,n):e.reduce((function(t,e){return t.replace(e,n)}),t)}class Re{ctx;constructor(t){this.ctx=t}get ctxId(){return this.ctx.baseInfo.id}setItem(t,e){return this.ctx.caller.callAsync("api:call",{method:"write-plugin-storage-file",args:[this.ctxId,t,e]})}getItem(t){return this.ctx.caller.callAsync("api:call",{method:"read-plugin-storage-file",args:[this.ctxId,t]})}removeItem(t){return this.ctx.caller.call("api:call",{method:"unlink-plugin-storage-file",args:[this.ctxId,t]})}clear(){return this.ctx.caller.call("api:call",{method:"clear-plugin-storage-files",args:[this.ctxId]})}hasItem(t){return this.ctx.caller.callAsync("api:call",{method:"exist-plugin-storage-file",args:[this.ctxId,t]})}}const Be=Symbol.for("proxy-continue"),Le=ie()("LSPlugin:user");function Ie(t,e,n){if("function"!=typeof n)return!1;const{key:r,label:o,desc:i,palette:s,keybinding:a}=e,c=`SimpleCommandHook${r}${++Ne}`;this.Editor["on"+c](n),this.caller?.call("api:call",{method:"register-plugin-simple-command",args:[this.baseInfo.id,[{key:r,label:o,type:t,desc:i,keybinding:a},["editor/hook",c]],s]})}const je={registerCommand:Ie,registerCommandPalette(t,e){const{key:n,label:r,keybinding:o}=t;return Ie.call(this,"global-palette-command",{key:n,label:r,palette:!0,keybinding:o},e)},registerUIItem(t,e){const n=this.baseInfo.id;this.caller?.call("api:call",{method:"register-plugin-ui-item",args:[n,t,e]})},registerPageMenuItem(t,e){if("function"!=typeof e)return!1;const n=t+"_"+this.baseInfo.id,r=t;Ie.call(this,"page-menu-item",{key:n,label:r},e)},setFullScreen(t){const e=(...t)=>this._callWin("setFullScreen",...t);"toggle"===t?this._callWin("isFullScreen").then((t=>{t?e():e(!0)})):t?e(!0):e()}};let Ne=0;const Ue={registerSlashCommand(t,e){Le("Register slash command #",this.baseInfo.id,t,e),"function"==typeof e&&(e=[["editor/clear-current-slash",!1],["editor/restore-saved-cursor"],["editor/hook",e]]),e=e.map((t=>{const[e,...n]=t;if("editor/hook"===e){let r=n[0],o=()=>{this.caller?.callUserModel(r)};"function"==typeof r&&(o=r);const i=`SlashCommandHook${e}${++Ne}`;t[1]=i,this.Editor["on"+i](o)}return t})),this.caller?.call("api:call",{method:"register-plugin-slash-command",args:[this.baseInfo.id,[t,e]]})},registerBlockContextMenuItem(t,e){if("function"!=typeof e)return!1;const n=t+"_"+this.baseInfo.id,r=t;Ie.call(this,"block-context-menu-item",{key:n,label:r},e)},scrollToBlockInPage(t,e){const n="block-content-"+e;this.App.pushState("page",{name:t},{anchor:n})}},Fe={};class Me extends(ge()){_baseInfo;_caller;_settingsSchema;_connected=!1;_ui=new Map;_fileStorage;_beforeunloadCallback;constructor(t,e){super(),this._baseInfo=t,this._caller=e,e.on("sys:ui:visible",(t=>{t?.toggle&&this.toggleMainUI()})),e.on("settings:changed",(t=>{const e=Object.assign({},this.settings),n=Object.assign(this._baseInfo.settings,t);this.emit("settings:changed",{...n},e)})),e.on("beforeunload",(async t=>{const{actor:n,...r}=t,o=this._beforeunloadCallback;try{o&&await o(r),n?.resolve(null)}catch(t){console.debug(`${e.debugTag} [beforeunload] `,t),n?.reject(t)}})),this._fileStorage=new Re(this)}async ready(t,e){if(!this._connected)try{"function"==typeof t&&(e=t,t={});let n=await this._caller.connectToParent(t);this._connected=!0,n=ne(this._baseInfo,n),this._settingsSchema&&(n.settings=function(t,e){const n=(e||[]).reduce(((t,e)=>("default"in e&&(t[e.key]=e.default),t)),{});return Object.assign(n,t)}(n.settings,this._settingsSchema),await this.useSettingsSchema(this._settingsSchema)),n?.id&&(this._caller.debugTag=`#${n.id} [${n.name}]`),e&&e.call(this,n)}catch(t){console.error("[LSPlugin Ready Error]",t)}}ensureConnected(){if(!this._connected)throw new Error("not connected")}beforeunload(t){"function"==typeof t&&(this._beforeunloadCallback=t)}provideModel(t){return this.caller._extendUserModel(t),this}provideTheme(t){return this.caller.call("provider:theme",t),this}provideStyle(t){return this.caller.call("provider:style",t),this}provideUI(t){return this.caller.call("provider:ui",t),this}useSettingsSchema(t){return this.connected&&this.caller.call("settings:schema",{schema:t,isSync:!0}),this._settingsSchema=t,this}updateSettings(t){this.caller.call("settings:update",t)}onSettingsChanged(t){const e="settings:changed";return this.on(e,t),()=>this.off(e,t)}showSettingsUI(){this.caller.call("settings:visible:changed",{visible:!0})}hideSettingsUI(){this.caller.call("settings:visible:changed",{visible:!1})}setMainUIAttrs(t){this.caller.call("main-ui:attrs",t)}setMainUIInlineStyle(t){this.caller.call("main-ui:style",t)}hideMainUI(t){const e={key:0,visible:!1,cursor:t?.restoreEditingCursor};this.caller.call("main-ui:visible",e),this.emit("ui:visible:changed",e),this._ui.set(e.key,e)}showMainUI(t){const e={key:0,visible:!0,autoFocus:t?.autoFocus};this.caller.call("main-ui:visible",e),this.emit("ui:visible:changed",e),this._ui.set(e.key,e)}toggleMainUI(){const t=this._ui.get(0);t&&t.visible?this.hideMainUI():this.showMainUI()}get isMainUIVisible(){const t=this._ui.get(0);return Boolean(t&&t.visible)}get connected(){return this._connected}get baseInfo(){return this._baseInfo}get settings(){return this.baseInfo?.settings}get caller(){return this._caller}resolveResourceFullUrl(t){if(this.ensureConnected(),t)return t=t.replace(/^[.\\/]+/,""),function(t,...e){try{const n=new URL(t);if(!n.origin)throw new Error(null);const r=te.join(t.substr(n.origin.length),...e);return n.origin+r}catch(n){return te.join(t,...e)}}(this._baseInfo.lsr,t)}_makeUserProxy(t,e){const n=this,r=this.caller;return new Proxy(t,{get(t,o,i){const s=t[o];return function(...t){if(!s||s.apply(n,t)===Be){if(e){const n=o.toString().match(/^(once|off|on)/i);if(null!=n){const o=n[0].toLowerCase(),s=n.input.slice(o.length),c=`hook:${e}:${i=s,void 0===a&&(a={}),function(t,e){return void 0===e&&(e={}),function(t,e){void 0===e&&(e={});for(var n=e.splitRegexp,r=void 0===n?ke:n,o=e.stripRegexp,i=void 0===o?xe:o,s=e.transform,a=void 0===s?Oe:s,c=e.delimiter,l=void 0===c?" ":c,u=Te(Te(t,r,"$1\0$2"),i,"\0"),h=0,f=u.length;"\0"===u.charAt(h);)h++;for(;"\0"===u.charAt(f-1);)f--;return u.slice(h,f).split("\0").map(a).join(l)}(t,Se({delimiter:"."},e))}(i,Se({delimiter:"_"},a))}`,l=t[0];return r[o](c,l),"off"!==o?()=>r.off(c,l):void 0}}var i,a;return r.callAsync("api:call",{tag:e,method:o,args:t})}}}})}_callWin(...t){return this._caller.callAsync("api:call",{method:"_callMainWin",args:t})}get App(){return this._makeUserProxy(je,"app")}get Editor(){return this._makeUserProxy(Ue,"editor")}get DB(){return this._makeUserProxy(Fe)}get FileStorage(){return this._fileStorage}}function Pe(t,e){return new Me(t,e)}if(null==window.__LSP__HOST__){const t=new Ce(null);window.logseq=Pe({},t)}})(),s})()})),o("cVm5l");const i=Object.create(null);i.open="0",i.close="1",i.ping="2",i.pong="3",i.message="4",i.upgrade="5",i.noop="6";const s=Object.create(null);Object.keys(i).forEach((t=>{s[i[t]]=t}));const a={type:"error",data:"parser error"},c="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===Object.prototype.toString.call(Blob),l="function"==typeof ArrayBuffer,u=(t,e)=>{const n=new FileReader;return n.onload=function(){const t=n.result.split(",")[1];e("b"+t)},n.readAsDataURL(t)};var h=({type:t,data:e},n,r)=>{return c&&e instanceof Blob?n?r(e):u(e,r):l&&(e instanceof ArrayBuffer||(o=e,"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(o):o&&o.buffer instanceof ArrayBuffer))?n?r(e):u(new Blob([e]),r):r(i[t]+(e||""));var o};const f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",p="undefined"==typeof Uint8Array?[]:new Uint8Array(256);for(let t=0;t<f.length;t++)p[f.charCodeAt(t)]=t;const d=t=>{let e,n,r,o,i,s=.75*t.length,a=t.length,c=0;"="===t[t.length-1]&&(s--,"="===t[t.length-2]&&s--);const l=new ArrayBuffer(s),u=new Uint8Array(l);for(e=0;e<a;e+=4)n=p[t.charCodeAt(e)],r=p[t.charCodeAt(e+1)],o=p[t.charCodeAt(e+2)],i=p[t.charCodeAt(e+3)],u[c++]=n<<2|r>>4,u[c++]=(15&r)<<4|o>>2,u[c++]=(3&o)<<6|63&i;return l},g="function"==typeof ArrayBuffer,y=(t,e)=>{if(g){const n=d(t);return m(n,e)}return{base64:!0,data:t}},m=(t,e)=>"blob"===e&&t instanceof ArrayBuffer?new Blob([t]):t;var b=(t,e)=>{if("string"!=typeof t)return{type:"message",data:m(t,e)};const n=t.charAt(0);if("b"===n)return{type:"message",data:y(t.substring(1),e)};return s[n]?t.length>1?{type:s[n],data:t.substring(1)}:{type:s[n]}:a};const v=String.fromCharCode(30),w=(t,e)=>{const n=t.length,r=new Array(n);let o=0;t.forEach(((t,i)=>{h(t,!1,(t=>{r[i]=t,++o===n&&e(r.join(v))}))}))},_=(t,e)=>{const n=t.split(v),r=[];for(let t=0;t<n.length;t++){const o=b(n[t],e);if(r.push(o),"error"===o.type)break}return r};function A(t){if(t)return function(t){for(var e in A.prototype)t[e]=A.prototype[e];return t}(t)}A.prototype.on=A.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this},A.prototype.once=function(t,e){function n(){this.off(t,n),e.apply(this,arguments)}return n.fn=e,this.on(t,n),this},A.prototype.off=A.prototype.removeListener=A.prototype.removeAllListeners=A.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,r=this._callbacks["$"+t];if(!r)return this;if(1==arguments.length)return delete this._callbacks["$"+t],this;for(var o=0;o<r.length;o++)if((n=r[o])===e||n.fn===e){r.splice(o,1);break}return 0===r.length&&delete this._callbacks["$"+t],this},A.prototype.emit=function(t){this._callbacks=this._callbacks||{};for(var e=new Array(arguments.length-1),n=this._callbacks["$"+t],r=1;r<arguments.length;r++)e[r-1]=arguments[r];if(n){r=0;for(var o=(n=n.slice(0)).length;r<o;++r)n[r].apply(this,e)}return this},A.prototype.emitReserved=A.prototype.emit,A.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]},A.prototype.hasListeners=function(t){return!!this.listeners(t).length};const E="undefined"!=typeof self?self:"undefined"!=typeof window?window:Function("return this")();function C(t,...e){return e.reduce(((e,n)=>(t.hasOwnProperty(n)&&(e[n]=t[n]),e)),{})}const S=setTimeout,O=clearTimeout;function k(t,e){e.useNativeTimers?(t.setTimeoutFn=S.bind(E),t.clearTimeoutFn=O.bind(E)):(t.setTimeoutFn=setTimeout.bind(E),t.clearTimeoutFn=clearTimeout.bind(E))}class x extends Error{constructor(t,e,n){super(t),this.description=e,this.context=n,this.type="TransportError"}}class T extends A{constructor(t){super(),this.writable=!1,k(this,t),this.opts=t,this.query=t.query,this.readyState="",this.socket=t.socket}onError(t,e,n){return super.emitReserved("error",new x(t,e,n)),this}open(){return"closed"!==this.readyState&&""!==this.readyState||(this.readyState="opening",this.doOpen()),this}close(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this}send(t){"open"===this.readyState&&this.write(t)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(t){const e=b(t,this.socket.binaryType);this.onPacket(e)}onPacket(t){super.emitReserved("packet",t)}onClose(t){this.readyState="closed",super.emitReserved("close",t)}}const R="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),B={};let L,I=0,j=0;function N(t){let e="";do{e=R[t%64]+e,t=Math.floor(t/64)}while(t>0);return e}function U(){const t=N(+new Date);return t!==L?(I=0,L=t):t+"."+N(I++)}for(;j<64;j++)B[R[j]]=j;function F(t){let e="";for(let n in t)t.hasOwnProperty(n)&&(e.length&&(e+="&"),e+=encodeURIComponent(n)+"="+encodeURIComponent(t[n]));return e}function M(t){let e={},n=t.split("&");for(let t=0,r=n.length;t<r;t++){let r=n[t].split("=");e[decodeURIComponent(r[0])]=decodeURIComponent(r[1])}return e}let P=!1;try{P="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(t){}const D=P;function z(t){const e=t.xdomain;try{if("undefined"!=typeof XMLHttpRequest&&(!e||D))return new XMLHttpRequest}catch(t){}if(!e)try{return new(E[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(t){}}function $(){}const q=null!=new z({xdomain:!1}).responseType;class H extends A{constructor(t,e){super(),k(this,e),this.opts=e,this.method=e.method||"GET",this.uri=t,this.async=!1!==e.async,this.data=void 0!==e.data?e.data:null,this.create()}create(){const t=C(this.opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");t.xdomain=!!this.opts.xd,t.xscheme=!!this.opts.xs;const e=this.xhr=new z(t);try{e.open(this.method,this.uri,this.async);try{if(this.opts.extraHeaders){e.setDisableHeaderCheck&&e.setDisableHeaderCheck(!0);for(let t in this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(t)&&e.setRequestHeader(t,this.opts.extraHeaders[t])}}catch(t){}if("POST"===this.method)try{e.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(t){}try{e.setRequestHeader("Accept","*/*")}catch(t){}"withCredentials"in e&&(e.withCredentials=this.opts.withCredentials),this.opts.requestTimeout&&(e.timeout=this.opts.requestTimeout),e.onreadystatechange=()=>{4===e.readyState&&(200===e.status||1223===e.status?this.onLoad():this.setTimeoutFn((()=>{this.onError("number"==typeof e.status?e.status:0)}),0))},e.send(this.data)}catch(t){return void this.setTimeoutFn((()=>{this.onError(t)}),0)}"undefined"!=typeof document&&(this.index=H.requestsCount++,H.requests[this.index]=this)}onError(t){this.emitReserved("error",t,this.xhr),this.cleanup(!0)}cleanup(t){if(void 0!==this.xhr&&null!==this.xhr){if(this.xhr.onreadystatechange=$,t)try{this.xhr.abort()}catch(t){}"undefined"!=typeof document&&delete H.requests[this.index],this.xhr=null}}onLoad(){const t=this.xhr.responseText;null!==t&&(this.emitReserved("data",t),this.emitReserved("success"),this.cleanup())}abort(){this.cleanup()}}if(H.requestsCount=0,H.requests={},"undefined"!=typeof document)if("function"==typeof attachEvent)attachEvent("onunload",V);else if("function"==typeof addEventListener){addEventListener("onpagehide"in E?"pagehide":"unload",V,!1)}function V(){for(let t in H.requests)H.requests.hasOwnProperty(t)&&H.requests[t].abort()}const W="function"==typeof Promise&&"function"==typeof Promise.resolve?t=>Promise.resolve().then(t):(t,e)=>e(t,0),G=E.WebSocket||E.MozWebSocket;var J,Y;J=function(t){var e,n,r=ot(t),o=r[0],i=r[1],s=new tt(function(t,e,n){return 3*(e+n)/4-n}(0,o,i)),a=0,c=i>0?o-4:o;for(n=0;n<c;n+=4)e=Q[t.charCodeAt(n)]<<18|Q[t.charCodeAt(n+1)]<<12|Q[t.charCodeAt(n+2)]<<6|Q[t.charCodeAt(n+3)],s[a++]=e>>16&255,s[a++]=e>>8&255,s[a++]=255&e;2===i&&(e=Q[t.charCodeAt(n)]<<2|Q[t.charCodeAt(n+1)]>>4,s[a++]=255&e);1===i&&(e=Q[t.charCodeAt(n)]<<10|Q[t.charCodeAt(n+1)]<<4|Q[t.charCodeAt(n+2)]>>2,s[a++]=e>>8&255,s[a++]=255&e);return s},Y=function(t){for(var e,n=t.length,r=n%3,o=[],i=16383,s=0,a=n-r;s<a;s+=i)o.push(it(t,s,s+i>a?a:s+i));1===r?(e=t[n-1],o.push(X[e>>2]+X[e<<4&63]+"==")):2===r&&(e=(t[n-2]<<8)+t[n-1],o.push(X[e>>10]+X[e>>4&63]+X[e<<2&63]+"="));return o.join("")}
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */;for(var K,Z,X=[],Q=[],tt="undefined"!=typeof Uint8Array?Uint8Array:Array,et="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",nt=0,rt=et.length;nt<rt;++nt)X[nt]=et[nt],Q[et.charCodeAt(nt)]=nt;function ot(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");return-1===n&&(n=e),[n,n===e?0:4-n%4]}function it(t,e,n){for(var r,o,i=[],s=e;s<n;s+=3)r=(t[s]<<16&16711680)+(t[s+1]<<8&65280)+(255&t[s+2]),i.push(X[(o=r)>>18&63]+X[o>>12&63]+X[o>>6&63]+X[63&o]);return i.join("")}Q["-".charCodeAt(0)]=62,Q["_".charCodeAt(0)]=63,K=function(t,e,n,r,o){var i,s,a=8*o-r-1,c=(1<<a)-1,l=c>>1,u=-7,h=n?o-1:0,f=n?-1:1,p=t[e+h];for(h+=f,i=p&(1<<-u)-1,p>>=-u,u+=a;u>0;i=256*i+t[e+h],h+=f,u-=8);for(s=i&(1<<-u)-1,i>>=-u,u+=r;u>0;s=256*s+t[e+h],h+=f,u-=8);if(0===i)i=1-l;else{if(i===c)return s?NaN:1/0*(p?-1:1);s+=Math.pow(2,r),i-=l}return(p?-1:1)*s*Math.pow(2,i-r)},Z=function(t,e,n,r,o,i){var s,a,c,l=8*i-o-1,u=(1<<l)-1,h=u>>1,f=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:i-1,d=r?1:-1,g=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=u):(s=Math.floor(Math.log(e)/Math.LN2),e*(c=Math.pow(2,-s))<1&&(s--,c*=2),(e+=s+h>=1?f/c:f*Math.pow(2,1-h))*c>=2&&(s++,c/=2),s+h>=u?(a=0,s=u):s+h>=1?(a=(e*c-1)*Math.pow(2,o),s+=h):(a=e*Math.pow(2,h-1)*Math.pow(2,o),s=0));o>=8;t[n+p]=255&a,p+=d,a/=256,o-=8);for(s=s<<o|a,l+=o;l>0;t[n+p]=255&s,p+=d,s/=256,l-=8);t[n+p-d]|=128*g};const st="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;function at(t){if(t>2147483647)throw new RangeError('The value "'+t+'" is invalid for option "size"');const e=new Uint8Array(t);return Object.setPrototypeOf(e,ct.prototype),e}function ct(t,e,n){if("number"==typeof t){if("string"==typeof e)throw new TypeError('The "string" argument must be of type string. Received type number');return ht(t)}return lt(t,e,n)}function lt(t,e,n){if("string"==typeof t)return function(t,e){"string"==typeof e&&""!==e||(e="utf8");if(!ct.isEncoding(e))throw new TypeError("Unknown encoding: "+e);const n=0|gt(t,e);let r=at(n);const o=r.write(t,e);o!==n&&(r=r.slice(0,o));return r}(t,e);if(ArrayBuffer.isView(t))return function(t){if(Jt(t,Uint8Array)){const e=new Uint8Array(t);return pt(e.buffer,e.byteOffset,e.byteLength)}return ft(t)}(t);if(null==t)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t);if(Jt(t,ArrayBuffer)||t&&Jt(t.buffer,ArrayBuffer))return pt(t,e,n);if("undefined"!=typeof SharedArrayBuffer&&(Jt(t,SharedArrayBuffer)||t&&Jt(t.buffer,SharedArrayBuffer)))return pt(t,e,n);if("number"==typeof t)throw new TypeError('The "value" argument must not be of type number. Received type number');const r=t.valueOf&&t.valueOf();if(null!=r&&r!==t)return ct.from(r,e,n);const o=function(t){if(ct.isBuffer(t)){const e=0|dt(t.length),n=at(e);return 0===n.length||t.copy(n,0,0,e),n}if(void 0!==t.length)return"number"!=typeof t.length||Yt(t.length)?at(0):ft(t);if("Buffer"===t.type&&Array.isArray(t.data))return ft(t.data)}(t);if(o)return o;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof t[Symbol.toPrimitive])return ct.from(t[Symbol.toPrimitive]("string"),e,n);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t)}function ut(t){if("number"!=typeof t)throw new TypeError('"size" argument must be of type number');if(t<0)throw new RangeError('The value "'+t+'" is invalid for option "size"')}function ht(t){return ut(t),at(t<0?0:0|dt(t))}function ft(t){const e=t.length<0?0:0|dt(t.length),n=at(e);for(let r=0;r<e;r+=1)n[r]=255&t[r];return n}function pt(t,e,n){if(e<0||t.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(t.byteLength<e+(n||0))throw new RangeError('"length" is outside of buffer bounds');let r;return r=void 0===e&&void 0===n?new Uint8Array(t):void 0===n?new Uint8Array(t,e):new Uint8Array(t,e,n),Object.setPrototypeOf(r,ct.prototype),r}function dt(t){if(t>=2147483647)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+2147483647..toString(16)+" bytes");return 0|t}function gt(t,e){if(ct.isBuffer(t))return t.length;if(ArrayBuffer.isView(t)||Jt(t,ArrayBuffer))return t.byteLength;if("string"!=typeof t)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof t);const n=t.length,r=arguments.length>2&&!0===arguments[2];if(!r&&0===n)return 0;let o=!1;for(;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return Vt(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return Wt(t).length;default:if(o)return r?-1:Vt(t).length;e=(""+e).toLowerCase(),o=!0}}function yt(t,e,n){let r=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return Tt(this,e,n);case"utf8":case"utf-8":return Ot(this,e,n);case"ascii":return kt(this,e,n);case"latin1":case"binary":return xt(this,e,n);case"base64":return St(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Rt(this,e,n);default:if(r)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),r=!0}}function mt(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}function bt(t,e,n,r,o){if(0===t.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),Yt(n=+n)&&(n=o?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(o)return-1;n=t.length-1}else if(n<0){if(!o)return-1;n=0}if("string"==typeof e&&(e=ct.from(e,r)),ct.isBuffer(e))return 0===e.length?-1:vt(t,e,n,r,o);if("number"==typeof e)return e&=255,"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):vt(t,[e],n,r,o);throw new TypeError("val must be string, number or Buffer")}function vt(t,e,n,r,o){let i,s=1,a=t.length,c=e.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(t.length<2||e.length<2)return-1;s=2,a/=2,c/=2,n/=2}function l(t,e){return 1===s?t[e]:t.readUInt16BE(e*s)}if(o){let r=-1;for(i=n;i<a;i++)if(l(t,i)===l(e,-1===r?0:i-r)){if(-1===r&&(r=i),i-r+1===c)return r*s}else-1!==r&&(i-=i-r),r=-1}else for(n+c>a&&(n=a-c),i=n;i>=0;i--){let n=!0;for(let r=0;r<c;r++)if(l(t,i+r)!==l(e,r)){n=!1;break}if(n)return i}return-1}function wt(t,e,n,r){n=Number(n)||0;const o=t.length-n;r?(r=Number(r))>o&&(r=o):r=o;const i=e.length;let s;for(r>i/2&&(r=i/2),s=0;s<r;++s){const r=parseInt(e.substr(2*s,2),16);if(Yt(r))return s;t[n+s]=r}return s}function _t(t,e,n,r){return Gt(Vt(e,t.length-n),t,n,r)}function At(t,e,n,r){return Gt(function(t){const e=[];for(let n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}(e),t,n,r)}function Et(t,e,n,r){return Gt(Wt(e),t,n,r)}function Ct(t,e,n,r){return Gt(function(t,e){let n,r,o;const i=[];for(let s=0;s<t.length&&!((e-=2)<0);++s)n=t.charCodeAt(s),r=n>>8,o=n%256,i.push(o),i.push(r);return i}(e,t.length-n),t,n,r)}function St(t,e,n){return 0===e&&n===t.length?Y(t):Y(t.slice(e,n))}function Ot(t,e,n){n=Math.min(t.length,n);const r=[];let o=e;for(;o<n;){const e=t[o];let i=null,s=e>239?4:e>223?3:e>191?2:1;if(o+s<=n){let n,r,a,c;switch(s){case 1:e<128&&(i=e);break;case 2:n=t[o+1],128==(192&n)&&(c=(31&e)<<6|63&n,c>127&&(i=c));break;case 3:n=t[o+1],r=t[o+2],128==(192&n)&&128==(192&r)&&(c=(15&e)<<12|(63&n)<<6|63&r,c>2047&&(c<55296||c>57343)&&(i=c));break;case 4:n=t[o+1],r=t[o+2],a=t[o+3],128==(192&n)&&128==(192&r)&&128==(192&a)&&(c=(15&e)<<18|(63&n)<<12|(63&r)<<6|63&a,c>65535&&c<1114112&&(i=c))}}null===i?(i=65533,s=1):i>65535&&(i-=65536,r.push(i>>>10&1023|55296),i=56320|1023&i),r.push(i),o+=s}return function(t){const e=t.length;if(e<=4096)return String.fromCharCode.apply(String,t);let n="",r=0;for(;r<e;)n+=String.fromCharCode.apply(String,t.slice(r,r+=4096));return n}(r)}ct.TYPED_ARRAY_SUPPORT=function(){try{const t=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(t,e),42===t.foo()}catch(t){return!1}}(),ct.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(ct.prototype,"parent",{enumerable:!0,get:function(){if(ct.isBuffer(this))return this.buffer}}),Object.defineProperty(ct.prototype,"offset",{enumerable:!0,get:function(){if(ct.isBuffer(this))return this.byteOffset}}),ct.poolSize=8192,ct.from=function(t,e,n){return lt(t,e,n)},Object.setPrototypeOf(ct.prototype,Uint8Array.prototype),Object.setPrototypeOf(ct,Uint8Array),ct.alloc=function(t,e,n){return function(t,e,n){return ut(t),t<=0?at(t):void 0!==e?"string"==typeof n?at(t).fill(e,n):at(t).fill(e):at(t)}(t,e,n)},ct.allocUnsafe=function(t){return ht(t)},ct.allocUnsafeSlow=function(t){return ht(t)},ct.isBuffer=function(t){return null!=t&&!0===t._isBuffer&&t!==ct.prototype},ct.compare=function(t,e){if(Jt(t,Uint8Array)&&(t=ct.from(t,t.offset,t.byteLength)),Jt(e,Uint8Array)&&(e=ct.from(e,e.offset,e.byteLength)),!ct.isBuffer(t)||!ct.isBuffer(e))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(t===e)return 0;let n=t.length,r=e.length;for(let o=0,i=Math.min(n,r);o<i;++o)if(t[o]!==e[o]){n=t[o],r=e[o];break}return n<r?-1:r<n?1:0},ct.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},ct.concat=function(t,e){if(!Array.isArray(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return ct.alloc(0);let n;if(void 0===e)for(e=0,n=0;n<t.length;++n)e+=t[n].length;const r=ct.allocUnsafe(e);let o=0;for(n=0;n<t.length;++n){let e=t[n];if(Jt(e,Uint8Array))o+e.length>r.length?(ct.isBuffer(e)||(e=ct.from(e)),e.copy(r,o)):Uint8Array.prototype.set.call(r,e,o);else{if(!ct.isBuffer(e))throw new TypeError('"list" argument must be an Array of Buffers');e.copy(r,o)}o+=e.length}return r},ct.byteLength=gt,ct.prototype._isBuffer=!0,ct.prototype.swap16=function(){const t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let e=0;e<t;e+=2)mt(this,e,e+1);return this},ct.prototype.swap32=function(){const t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let e=0;e<t;e+=4)mt(this,e,e+3),mt(this,e+1,e+2);return this},ct.prototype.swap64=function(){const t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let e=0;e<t;e+=8)mt(this,e,e+7),mt(this,e+1,e+6),mt(this,e+2,e+5),mt(this,e+3,e+4);return this},ct.prototype.toString=function(){const t=this.length;return 0===t?"":0===arguments.length?Ot(this,0,t):yt.apply(this,arguments)},ct.prototype.toLocaleString=ct.prototype.toString,ct.prototype.equals=function(t){if(!ct.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===ct.compare(this,t)},ct.prototype.inspect=function(){let t="";return t=this.toString("hex",0,50).replace(/(.{2})/g,"$1 ").trim(),this.length>50&&(t+=" ... "),"<Buffer "+t+">"},st&&(ct.prototype[st]=ct.prototype.inspect),ct.prototype.compare=function(t,e,n,r,o){if(Jt(t,Uint8Array)&&(t=ct.from(t,t.offset,t.byteLength)),!ct.isBuffer(t))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof t);if(void 0===e&&(e=0),void 0===n&&(n=t?t.length:0),void 0===r&&(r=0),void 0===o&&(o=this.length),e<0||n>t.length||r<0||o>this.length)throw new RangeError("out of range index");if(r>=o&&e>=n)return 0;if(r>=o)return-1;if(e>=n)return 1;if(this===t)return 0;let i=(o>>>=0)-(r>>>=0),s=(n>>>=0)-(e>>>=0);const a=Math.min(i,s),c=this.slice(r,o),l=t.slice(e,n);for(let t=0;t<a;++t)if(c[t]!==l[t]){i=c[t],s=l[t];break}return i<s?-1:s<i?1:0},ct.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},ct.prototype.indexOf=function(t,e,n){return bt(this,t,e,n,!0)},ct.prototype.lastIndexOf=function(t,e,n){return bt(this,t,e,n,!1)},ct.prototype.write=function(t,e,n,r){if(void 0===e)r="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)r=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e>>>=0,isFinite(n)?(n>>>=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}const o=this.length-e;if((void 0===n||n>o)&&(n=o),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");let i=!1;for(;;)switch(r){case"hex":return wt(this,t,e,n);case"utf8":case"utf-8":return _t(this,t,e,n);case"ascii":case"latin1":case"binary":return At(this,t,e,n);case"base64":return Et(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Ct(this,t,e,n);default:if(i)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),i=!0}},ct.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function kt(t,e,n){let r="";n=Math.min(t.length,n);for(let o=e;o<n;++o)r+=String.fromCharCode(127&t[o]);return r}function xt(t,e,n){let r="";n=Math.min(t.length,n);for(let o=e;o<n;++o)r+=String.fromCharCode(t[o]);return r}function Tt(t,e,n){const r=t.length;(!e||e<0)&&(e=0),(!n||n<0||n>r)&&(n=r);let o="";for(let r=e;r<n;++r)o+=Kt[t[r]];return o}function Rt(t,e,n){const r=t.slice(e,n);let o="";for(let t=0;t<r.length-1;t+=2)o+=String.fromCharCode(r[t]+256*r[t+1]);return o}function Bt(t,e,n){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function Lt(t,e,n,r,o,i){if(!ct.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>o||e<i)throw new RangeError('"value" argument is out of bounds');if(n+r>t.length)throw new RangeError("Index out of range")}function It(t,e,n,r,o){zt(e,r,o,t,n,7);let i=Number(e&BigInt(4294967295));t[n++]=i,i>>=8,t[n++]=i,i>>=8,t[n++]=i,i>>=8,t[n++]=i;let s=Number(e>>BigInt(32)&BigInt(4294967295));return t[n++]=s,s>>=8,t[n++]=s,s>>=8,t[n++]=s,s>>=8,t[n++]=s,n}function jt(t,e,n,r,o){zt(e,r,o,t,n,7);let i=Number(e&BigInt(4294967295));t[n+7]=i,i>>=8,t[n+6]=i,i>>=8,t[n+5]=i,i>>=8,t[n+4]=i;let s=Number(e>>BigInt(32)&BigInt(4294967295));return t[n+3]=s,s>>=8,t[n+2]=s,s>>=8,t[n+1]=s,s>>=8,t[n]=s,n+8}function Nt(t,e,n,r,o,i){if(n+r>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function Ut(t,e,n,r,o){return e=+e,n>>>=0,o||Nt(t,0,n,4),Z(t,e,n,r,23,4),n+4}function Ft(t,e,n,r,o){return e=+e,n>>>=0,o||Nt(t,0,n,8),Z(t,e,n,r,52,8),n+8}ct.prototype.slice=function(t,e){const n=this.length;(t=~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),(e=void 0===e?n:~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),e<t&&(e=t);const r=this.subarray(t,e);return Object.setPrototypeOf(r,ct.prototype),r},ct.prototype.readUintLE=ct.prototype.readUIntLE=function(t,e,n){t>>>=0,e>>>=0,n||Bt(t,e,this.length);let r=this[t],o=1,i=0;for(;++i<e&&(o*=256);)r+=this[t+i]*o;return r},ct.prototype.readUintBE=ct.prototype.readUIntBE=function(t,e,n){t>>>=0,e>>>=0,n||Bt(t,e,this.length);let r=this[t+--e],o=1;for(;e>0&&(o*=256);)r+=this[t+--e]*o;return r},ct.prototype.readUint8=ct.prototype.readUInt8=function(t,e){return t>>>=0,e||Bt(t,1,this.length),this[t]},ct.prototype.readUint16LE=ct.prototype.readUInt16LE=function(t,e){return t>>>=0,e||Bt(t,2,this.length),this[t]|this[t+1]<<8},ct.prototype.readUint16BE=ct.prototype.readUInt16BE=function(t,e){return t>>>=0,e||Bt(t,2,this.length),this[t]<<8|this[t+1]},ct.prototype.readUint32LE=ct.prototype.readUInt32LE=function(t,e){return t>>>=0,e||Bt(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},ct.prototype.readUint32BE=ct.prototype.readUInt32BE=function(t,e){return t>>>=0,e||Bt(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},ct.prototype.readBigUInt64LE=Zt((function(t){$t(t>>>=0,"offset");const e=this[t],n=this[t+7];void 0!==e&&void 0!==n||qt(t,this.length-8);const r=e+256*this[++t]+65536*this[++t]+this[++t]*2**24,o=this[++t]+256*this[++t]+65536*this[++t]+n*2**24;return BigInt(r)+(BigInt(o)<<BigInt(32))})),ct.prototype.readBigUInt64BE=Zt((function(t){$t(t>>>=0,"offset");const e=this[t],n=this[t+7];void 0!==e&&void 0!==n||qt(t,this.length-8);const r=e*2**24+65536*this[++t]+256*this[++t]+this[++t],o=this[++t]*2**24+65536*this[++t]+256*this[++t]+n;return(BigInt(r)<<BigInt(32))+BigInt(o)})),ct.prototype.readIntLE=function(t,e,n){t>>>=0,e>>>=0,n||Bt(t,e,this.length);let r=this[t],o=1,i=0;for(;++i<e&&(o*=256);)r+=this[t+i]*o;return o*=128,r>=o&&(r-=Math.pow(2,8*e)),r},ct.prototype.readIntBE=function(t,e,n){t>>>=0,e>>>=0,n||Bt(t,e,this.length);let r=e,o=1,i=this[t+--r];for(;r>0&&(o*=256);)i+=this[t+--r]*o;return o*=128,i>=o&&(i-=Math.pow(2,8*e)),i},ct.prototype.readInt8=function(t,e){return t>>>=0,e||Bt(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},ct.prototype.readInt16LE=function(t,e){t>>>=0,e||Bt(t,2,this.length);const n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},ct.prototype.readInt16BE=function(t,e){t>>>=0,e||Bt(t,2,this.length);const n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},ct.prototype.readInt32LE=function(t,e){return t>>>=0,e||Bt(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},ct.prototype.readInt32BE=function(t,e){return t>>>=0,e||Bt(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},ct.prototype.readBigInt64LE=Zt((function(t){$t(t>>>=0,"offset");const e=this[t],n=this[t+7];void 0!==e&&void 0!==n||qt(t,this.length-8);const r=this[t+4]+256*this[t+5]+65536*this[t+6]+(n<<24);return(BigInt(r)<<BigInt(32))+BigInt(e+256*this[++t]+65536*this[++t]+this[++t]*2**24)})),ct.prototype.readBigInt64BE=Zt((function(t){$t(t>>>=0,"offset");const e=this[t],n=this[t+7];void 0!==e&&void 0!==n||qt(t,this.length-8);const r=(e<<24)+65536*this[++t]+256*this[++t]+this[++t];return(BigInt(r)<<BigInt(32))+BigInt(this[++t]*2**24+65536*this[++t]+256*this[++t]+n)})),ct.prototype.readFloatLE=function(t,e){return t>>>=0,e||Bt(t,4,this.length),K(this,t,!0,23,4)},ct.prototype.readFloatBE=function(t,e){return t>>>=0,e||Bt(t,4,this.length),K(this,t,!1,23,4)},ct.prototype.readDoubleLE=function(t,e){return t>>>=0,e||Bt(t,8,this.length),K(this,t,!0,52,8)},ct.prototype.readDoubleBE=function(t,e){return t>>>=0,e||Bt(t,8,this.length),K(this,t,!1,52,8)},ct.prototype.writeUintLE=ct.prototype.writeUIntLE=function(t,e,n,r){if(t=+t,e>>>=0,n>>>=0,!r){Lt(this,t,e,n,Math.pow(2,8*n)-1,0)}let o=1,i=0;for(this[e]=255&t;++i<n&&(o*=256);)this[e+i]=t/o&255;return e+n},ct.prototype.writeUintBE=ct.prototype.writeUIntBE=function(t,e,n,r){if(t=+t,e>>>=0,n>>>=0,!r){Lt(this,t,e,n,Math.pow(2,8*n)-1,0)}let o=n-1,i=1;for(this[e+o]=255&t;--o>=0&&(i*=256);)this[e+o]=t/i&255;return e+n},ct.prototype.writeUint8=ct.prototype.writeUInt8=function(t,e,n){return t=+t,e>>>=0,n||Lt(this,t,e,1,255,0),this[e]=255&t,e+1},ct.prototype.writeUint16LE=ct.prototype.writeUInt16LE=function(t,e,n){return t=+t,e>>>=0,n||Lt(this,t,e,2,65535,0),this[e]=255&t,this[e+1]=t>>>8,e+2},ct.prototype.writeUint16BE=ct.prototype.writeUInt16BE=function(t,e,n){return t=+t,e>>>=0,n||Lt(this,t,e,2,65535,0),this[e]=t>>>8,this[e+1]=255&t,e+2},ct.prototype.writeUint32LE=ct.prototype.writeUInt32LE=function(t,e,n){return t=+t,e>>>=0,n||Lt(this,t,e,4,4294967295,0),this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t,e+4},ct.prototype.writeUint32BE=ct.prototype.writeUInt32BE=function(t,e,n){return t=+t,e>>>=0,n||Lt(this,t,e,4,4294967295,0),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},ct.prototype.writeBigUInt64LE=Zt((function(t,e=0){return It(this,t,e,BigInt(0),BigInt("0xffffffffffffffff"))})),ct.prototype.writeBigUInt64BE=Zt((function(t,e=0){return jt(this,t,e,BigInt(0),BigInt("0xffffffffffffffff"))})),ct.prototype.writeIntLE=function(t,e,n,r){if(t=+t,e>>>=0,!r){const r=Math.pow(2,8*n-1);Lt(this,t,e,n,r-1,-r)}let o=0,i=1,s=0;for(this[e]=255&t;++o<n&&(i*=256);)t<0&&0===s&&0!==this[e+o-1]&&(s=1),this[e+o]=(t/i>>0)-s&255;return e+n},ct.prototype.writeIntBE=function(t,e,n,r){if(t=+t,e>>>=0,!r){const r=Math.pow(2,8*n-1);Lt(this,t,e,n,r-1,-r)}let o=n-1,i=1,s=0;for(this[e+o]=255&t;--o>=0&&(i*=256);)t<0&&0===s&&0!==this[e+o+1]&&(s=1),this[e+o]=(t/i>>0)-s&255;return e+n},ct.prototype.writeInt8=function(t,e,n){return t=+t,e>>>=0,n||Lt(this,t,e,1,127,-128),t<0&&(t=255+t+1),this[e]=255&t,e+1},ct.prototype.writeInt16LE=function(t,e,n){return t=+t,e>>>=0,n||Lt(this,t,e,2,32767,-32768),this[e]=255&t,this[e+1]=t>>>8,e+2},ct.prototype.writeInt16BE=function(t,e,n){return t=+t,e>>>=0,n||Lt(this,t,e,2,32767,-32768),this[e]=t>>>8,this[e+1]=255&t,e+2},ct.prototype.writeInt32LE=function(t,e,n){return t=+t,e>>>=0,n||Lt(this,t,e,4,2147483647,-2147483648),this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24,e+4},ct.prototype.writeInt32BE=function(t,e,n){return t=+t,e>>>=0,n||Lt(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},ct.prototype.writeBigInt64LE=Zt((function(t,e=0){return It(this,t,e,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),ct.prototype.writeBigInt64BE=Zt((function(t,e=0){return jt(this,t,e,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),ct.prototype.writeFloatLE=function(t,e,n){return Ut(this,t,e,!0,n)},ct.prototype.writeFloatBE=function(t,e,n){return Ut(this,t,e,!1,n)},ct.prototype.writeDoubleLE=function(t,e,n){return Ft(this,t,e,!0,n)},ct.prototype.writeDoubleBE=function(t,e,n){return Ft(this,t,e,!1,n)},ct.prototype.copy=function(t,e,n,r){if(!ct.isBuffer(t))throw new TypeError("argument should be a Buffer");if(n||(n=0),r||0===r||(r=this.length),e>=t.length&&(e=t.length),e||(e=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),t.length-e<r-n&&(r=t.length-e+n);const o=r-n;return this===t&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(e,n,r):Uint8Array.prototype.set.call(t,this.subarray(n,r),e),o},ct.prototype.fill=function(t,e,n,r){if("string"==typeof t){if("string"==typeof e?(r=e,e=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!ct.isEncoding(r))throw new TypeError("Unknown encoding: "+r);if(1===t.length){const e=t.charCodeAt(0);("utf8"===r&&e<128||"latin1"===r)&&(t=e)}}else"number"==typeof t?t&=255:"boolean"==typeof t&&(t=Number(t));if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;let o;if(e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0),"number"==typeof t)for(o=e;o<n;++o)this[o]=t;else{const i=ct.isBuffer(t)?t:ct.from(t,r),s=i.length;if(0===s)throw new TypeError('The value "'+t+'" is invalid for argument "value"');for(o=0;o<n-e;++o)this[o+e]=i[o%s]}return this};const Mt={};function Pt(t,e,n){Mt[t]=class extends n{constructor(){super(),Object.defineProperty(this,"message",{value:e.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${t}]`,this.stack,delete this.name}get code(){return t}set code(t){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:t,writable:!0})}toString(){return`${this.name} [${t}]: ${this.message}`}}}function Dt(t){let e="",n=t.length;const r="-"===t[0]?1:0;for(;n>=r+4;n-=3)e=`_${t.slice(n-3,n)}${e}`;return`${t.slice(0,n)}${e}`}function zt(t,e,n,r,o,i){if(t>n||t<e){const r="bigint"==typeof e?"n":"";let o;throw o=i>3?0===e||e===BigInt(0)?`>= 0${r} and < 2${r} ** ${8*(i+1)}${r}`:`>= -(2${r} ** ${8*(i+1)-1}${r}) and < 2 ** ${8*(i+1)-1}${r}`:`>= ${e}${r} and <= ${n}${r}`,new Mt.ERR_OUT_OF_RANGE("value",o,t)}!function(t,e,n){$t(e,"offset"),void 0!==t[e]&&void 0!==t[e+n]||qt(e,t.length-(n+1))}(r,o,i)}function $t(t,e){if("number"!=typeof t)throw new Mt.ERR_INVALID_ARG_TYPE(e,"number",t)}function qt(t,e,n){if(Math.floor(t)!==t)throw $t(t,n),new Mt.ERR_OUT_OF_RANGE(n||"offset","an integer",t);if(e<0)throw new Mt.ERR_BUFFER_OUT_OF_BOUNDS;throw new Mt.ERR_OUT_OF_RANGE(n||"offset",`>= ${n?1:0} and <= ${e}`,t)}Pt("ERR_BUFFER_OUT_OF_BOUNDS",(function(t){return t?`${t} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"}),RangeError),Pt("ERR_INVALID_ARG_TYPE",(function(t,e){return`The "${t}" argument must be of type number. Received type ${typeof e}`}),TypeError),Pt("ERR_OUT_OF_RANGE",(function(t,e,n){let r=`The value of "${t}" is out of range.`,o=n;return Number.isInteger(n)&&Math.abs(n)>2**32?o=Dt(String(n)):"bigint"==typeof n&&(o=String(n),(n>BigInt(2)**BigInt(32)||n<-(BigInt(2)**BigInt(32)))&&(o=Dt(o)),o+="n"),r+=` It must be ${e}. Received ${o}`,r}),RangeError);const Ht=/[^+/0-9A-Za-z-_]/g;function Vt(t,e){let n;e=e||1/0;const r=t.length;let o=null;const i=[];for(let s=0;s<r;++s){if(n=t.charCodeAt(s),n>55295&&n<57344){if(!o){if(n>56319){(e-=3)>-1&&i.push(239,191,189);continue}if(s+1===r){(e-=3)>-1&&i.push(239,191,189);continue}o=n;continue}if(n<56320){(e-=3)>-1&&i.push(239,191,189),o=n;continue}n=65536+(o-55296<<10|n-56320)}else o&&(e-=3)>-1&&i.push(239,191,189);if(o=null,n<128){if((e-=1)<0)break;i.push(n)}else if(n<2048){if((e-=2)<0)break;i.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;i.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;i.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return i}function Wt(t){return J(function(t){if((t=(t=t.split("=")[0]).trim().replace(Ht,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function Gt(t,e,n,r){let o;for(o=0;o<r&&!(o+n>=e.length||o>=t.length);++o)e[o+n]=t[o];return o}function Jt(t,e){return t instanceof e||null!=t&&null!=t.constructor&&null!=t.constructor.name&&t.constructor.name===e.name}function Yt(t){return t!=t}const Kt=function(){const t="0123456789abcdef",e=new Array(256);for(let n=0;n<16;++n){const r=16*n;for(let o=0;o<16;++o)e[r+o]=t[n]+t[o]}return e}();function Zt(t){return"undefined"==typeof BigInt?Xt:t}function Xt(){throw new Error("BigInt not supported")}const Qt="undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase();const te={websocket:class extends T{constructor(t){super(t),this.supportsBinary=!t.forceBase64}get name(){return"websocket"}doOpen(){if(!this.check())return;const t=this.uri(),e=this.opts.protocols,n=Qt?{}:C(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(n.headers=this.opts.extraHeaders);try{this.ws=Qt?new G(t,e,n):e?new G(t,e):new G(t)}catch(t){return this.emitReserved("error",t)}this.ws.binaryType=this.socket.binaryType||"arraybuffer",this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=t=>this.onClose({description:"websocket connection closed",context:t}),this.ws.onmessage=t=>this.onData(t.data),this.ws.onerror=t=>this.onError("websocket error",t)}write(t){this.writable=!1;for(let e=0;e<t.length;e++){const n=t[e],r=e===t.length-1;h(n,this.supportsBinary,(t=>{try{this.ws.send(t)}catch(t){}r&&W((()=>{this.writable=!0,this.emitReserved("drain")}),this.setTimeoutFn)}))}}doClose(){void 0!==this.ws&&(this.ws.close(),this.ws=null)}uri(){let t=this.query||{};const e=this.opts.secure?"wss":"ws";let n="";this.opts.port&&("wss"===e&&443!==Number(this.opts.port)||"ws"===e&&80!==Number(this.opts.port))&&(n=":"+this.opts.port),this.opts.timestampRequests&&(t[this.opts.timestampParam]=U()),this.supportsBinary||(t.b64=1);const r=F(t);return e+"://"+(-1!==this.opts.hostname.indexOf(":")?"["+this.opts.hostname+"]":this.opts.hostname)+n+this.opts.path+(r.length?"?"+r:"")}check(){return!!G}},polling:class extends T{constructor(t){if(super(t),this.polling=!1,"undefined"!=typeof location){const e="https:"===location.protocol;let n=location.port;n||(n=e?"443":"80"),this.xd="undefined"!=typeof location&&t.hostname!==location.hostname||n!==t.port,this.xs=t.secure!==e}const e=t&&t.forceBase64;this.supportsBinary=q&&!e}get name(){return"polling"}doOpen(){this.poll()}pause(t){this.readyState="pausing";const e=()=>{this.readyState="paused",t()};if(this.polling||!this.writable){let t=0;this.polling&&(t++,this.once("pollComplete",(function(){--t||e()}))),this.writable||(t++,this.once("drain",(function(){--t||e()})))}else e()}poll(){this.polling=!0,this.doPoll(),this.emitReserved("poll")}onData(t){_(t,this.socket.binaryType).forEach((t=>{if("opening"===this.readyState&&"open"===t.type&&this.onOpen(),"close"===t.type)return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(t)})),"closed"!==this.readyState&&(this.polling=!1,this.emitReserved("pollComplete"),"open"===this.readyState&&this.poll())}doClose(){const t=()=>{this.write([{type:"close"}])};"open"===this.readyState?t():this.once("open",t)}write(t){this.writable=!1,w(t,(t=>{this.doWrite(t,(()=>{this.writable=!0,this.emitReserved("drain")}))}))}uri(){let t=this.query||{};const e=this.opts.secure?"https":"http";let n="";!1!==this.opts.timestampRequests&&(t[this.opts.timestampParam]=U()),this.supportsBinary||t.sid||(t.b64=1),this.opts.port&&("https"===e&&443!==Number(this.opts.port)||"http"===e&&80!==Number(this.opts.port))&&(n=":"+this.opts.port);const r=F(t);return e+"://"+(-1!==this.opts.hostname.indexOf(":")?"["+this.opts.hostname+"]":this.opts.hostname)+n+this.opts.path+(r.length?"?"+r:"")}request(t={}){return Object.assign(t,{xd:this.xd,xs:this.xs},this.opts),new H(this.uri(),t)}doWrite(t,e){const n=this.request({method:"POST",data:t});n.on("success",e),n.on("error",((t,e)=>{this.onError("xhr post error",t,e)}))}doPoll(){const t=this.request();t.on("data",this.onData.bind(this)),t.on("error",((t,e)=>{this.onError("xhr poll error",t,e)})),this.pollXhr=t}}},ee=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,ne=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function re(t){const e=t,n=t.indexOf("["),r=t.indexOf("]");-1!=n&&-1!=r&&(t=t.substring(0,n)+t.substring(n,r).replace(/:/g,";")+t.substring(r,t.length));let o=ee.exec(t||""),i={},s=14;for(;s--;)i[ne[s]]=o[s]||"";return-1!=n&&-1!=r&&(i.source=e,i.host=i.host.substring(1,i.host.length-1).replace(/;/g,":"),i.authority=i.authority.replace("[","").replace("]","").replace(/;/g,":"),i.ipv6uri=!0),i.pathNames=function(t,e){const n=/\/{2,9}/g,r=e.replace(n,"/").split("/");"/"!=e.substr(0,1)&&0!==e.length||r.splice(0,1);"/"==e.substr(e.length-1,1)&&r.splice(r.length-1,1);return r}(0,i.path),i.queryKey=function(t,e){const n={};return e.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,(function(t,e,r){e&&(n[e]=r)})),n}(0,i.query),i}class oe extends A{constructor(t,e={}){super(),t&&"object"==typeof t&&(e=t,t=null),t?(t=re(t),e.hostname=t.host,e.secure="https"===t.protocol||"wss"===t.protocol,e.port=t.port,t.query&&(e.query=t.query)):e.host&&(e.hostname=re(e.host).host),k(this,e),this.secure=null!=e.secure?e.secure:"undefined"!=typeof location&&"https:"===location.protocol,e.hostname&&!e.port&&(e.port=this.secure?"443":"80"),this.hostname=e.hostname||("undefined"!=typeof location?location.hostname:"localhost"),this.port=e.port||("undefined"!=typeof location&&location.port?location.port:this.secure?"443":"80"),this.transports=e.transports||["polling","websocket"],this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!0},e),this.opts.path=this.opts.path.replace(/\/$/,"")+"/","string"==typeof this.opts.query&&(this.opts.query=M(this.opts.query)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingTimeoutTimer=null,"function"==typeof addEventListener&&(this.opts.closeOnBeforeunload&&addEventListener("beforeunload",(()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())}),!1),"localhost"!==this.hostname&&(this.offlineEventListener=()=>{this.onClose("transport close",{description:"network connection lost"})},addEventListener("offline",this.offlineEventListener,!1))),this.open()}createTransport(t){const e=Object.assign({},this.opts.query);e.EIO=4,e.transport=t,this.id&&(e.sid=this.id);const n=Object.assign({},this.opts.transportOptions[t],this.opts,{query:e,socket:this,hostname:this.hostname,secure:this.secure,port:this.port});return new te[t](n)}open(){let t;if(this.opts.rememberUpgrade&&oe.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))t="websocket";else{if(0===this.transports.length)return void this.setTimeoutFn((()=>{this.emitReserved("error","No transports available")}),0);t=this.transports[0]}this.readyState="opening";try{t=this.createTransport(t)}catch(t){return this.transports.shift(),void this.open()}t.open(),this.setTransport(t)}setTransport(t){this.transport&&this.transport.removeAllListeners(),this.transport=t,t.on("drain",this.onDrain.bind(this)).on("packet",this.onPacket.bind(this)).on("error",this.onError.bind(this)).on("close",(t=>this.onClose("transport close",t)))}probe(t){let e=this.createTransport(t),n=!1;oe.priorWebsocketSuccess=!1;const r=()=>{n||(e.send([{type:"ping",data:"probe"}]),e.once("packet",(t=>{if(!n)if("pong"===t.type&&"probe"===t.data){if(this.upgrading=!0,this.emitReserved("upgrading",e),!e)return;oe.priorWebsocketSuccess="websocket"===e.name,this.transport.pause((()=>{n||"closed"!==this.readyState&&(l(),this.setTransport(e),e.send([{type:"upgrade"}]),this.emitReserved("upgrade",e),e=null,this.upgrading=!1,this.flush())}))}else{const t=new Error("probe error");t.transport=e.name,this.emitReserved("upgradeError",t)}})))};function o(){n||(n=!0,l(),e.close(),e=null)}const i=t=>{const n=new Error("probe error: "+t);n.transport=e.name,o(),this.emitReserved("upgradeError",n)};function s(){i("transport closed")}function a(){i("socket closed")}function c(t){e&&t.name!==e.name&&o()}const l=()=>{e.removeListener("open",r),e.removeListener("error",i),e.removeListener("close",s),this.off("close",a),this.off("upgrading",c)};e.once("open",r),e.once("error",i),e.once("close",s),this.once("close",a),this.once("upgrading",c),e.open()}onOpen(){if(this.readyState="open",oe.priorWebsocketSuccess="websocket"===this.transport.name,this.emitReserved("open"),this.flush(),"open"===this.readyState&&this.opts.upgrade&&this.transport.pause){let t=0;const e=this.upgrades.length;for(;t<e;t++)this.probe(this.upgrades[t])}}onPacket(t){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(this.emitReserved("packet",t),this.emitReserved("heartbeat"),t.type){case"open":this.onHandshake(JSON.parse(t.data));break;case"ping":this.resetPingTimeout(),this.sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong");break;case"error":const e=new Error("server error");e.code=t.data,this.onError(e);break;case"message":this.emitReserved("data",t.data),this.emitReserved("message",t.data)}}onHandshake(t){this.emitReserved("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this.upgrades=this.filterUpgrades(t.upgrades),this.pingInterval=t.pingInterval,this.pingTimeout=t.pingTimeout,this.maxPayload=t.maxPayload,this.onOpen(),"closed"!==this.readyState&&this.resetPingTimeout()}resetPingTimeout(){this.clearTimeoutFn(this.pingTimeoutTimer),this.pingTimeoutTimer=this.setTimeoutFn((()=>{this.onClose("ping timeout")}),this.pingInterval+this.pingTimeout),this.opts.autoUnref&&this.pingTimeoutTimer.unref()}onDrain(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emitReserved("drain"):this.flush()}flush(){if("closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const t=this.getWritablePackets();this.transport.send(t),this.prevBufferLen=t.length,this.emitReserved("flush")}}getWritablePackets(){if(!(this.maxPayload&&"polling"===this.transport.name&&this.writeBuffer.length>1))return this.writeBuffer;let t=1;for(let n=0;n<this.writeBuffer.length;n++){const r=this.writeBuffer[n].data;if(r&&(t+="string"==typeof(e=r)?function(t){let e=0,n=0;for(let r=0,o=t.length;r<o;r++)e=t.charCodeAt(r),e<128?n+=1:e<2048?n+=2:e<55296||e>=57344?n+=3:(r++,n+=4);return n}(e):Math.ceil(1.33*(e.byteLength||e.size))),n>0&&t>this.maxPayload)return this.writeBuffer.slice(0,n);t+=2}var e;return this.writeBuffer}write(t,e,n){return this.sendPacket("message",t,e,n),this}send(t,e,n){return this.sendPacket("message",t,e,n),this}sendPacket(t,e,n,r){if("function"==typeof e&&(r=e,e=void 0),"function"==typeof n&&(r=n,n=null),"closing"===this.readyState||"closed"===this.readyState)return;(n=n||{}).compress=!1!==n.compress;const o={type:t,data:e,options:n};this.emitReserved("packetCreate",o),this.writeBuffer.push(o),r&&this.once("flush",r),this.flush()}close(){const t=()=>{this.onClose("forced close"),this.transport.close()},e=()=>{this.off("upgrade",e),this.off("upgradeError",e),t()},n=()=>{this.once("upgrade",e),this.once("upgradeError",e)};return"opening"!==this.readyState&&"open"!==this.readyState||(this.readyState="closing",this.writeBuffer.length?this.once("drain",(()=>{this.upgrading?n():t()})):this.upgrading?n():t()),this}onError(t){oe.priorWebsocketSuccess=!1,this.emitReserved("error",t),this.onClose("transport error",t)}onClose(t,e){"opening"!==this.readyState&&"open"!==this.readyState&&"closing"!==this.readyState||(this.clearTimeoutFn(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),"function"==typeof removeEventListener&&removeEventListener("offline",this.offlineEventListener,!1),this.readyState="closed",this.id=null,this.emitReserved("close",t,e),this.writeBuffer=[],this.prevBufferLen=0)}filterUpgrades(t){const e=[];let n=0;const r=t.length;for(;n<r;n++)~this.transports.indexOf(t[n])&&e.push(t[n]);return e}}oe.protocol=4;oe.protocol;function ie(t,e="",n){let r=t;n=n||"undefined"!=typeof location&&location,null==t&&(t=n.protocol+"//"+n.host),"string"==typeof t&&("/"===t.charAt(0)&&(t="/"===t.charAt(1)?n.protocol+t:n.host+t),/^(https?|wss?):\/\//.test(t)||(t=void 0!==n?n.protocol+"//"+t:"https://"+t),r=re(t)),r.port||(/^(http|ws)$/.test(r.protocol)?r.port="80":/^(http|ws)s$/.test(r.protocol)&&(r.port="443")),r.path=r.path||"/";const o=-1!==r.host.indexOf(":")?"["+r.host+"]":r.host;return r.id=r.protocol+"://"+o+":"+r.port+e,r.href=r.protocol+"://"+o+(n&&n.port===r.port?"":":"+r.port),r}var se={};e(se,"protocol",(()=>me)),e(se,"PacketType",(()=>be)),e(se,"Encoder",(()=>we)),e(se,"Decoder",(()=>_e));const ae="function"==typeof ArrayBuffer,ce=Object.prototype.toString,le="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===ce.call(Blob),ue="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===ce.call(File);function he(t){return ae&&(t instanceof ArrayBuffer||(t=>"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(t):t.buffer instanceof ArrayBuffer)(t))||le&&t instanceof Blob||ue&&t instanceof File}function fe(t,e){if(!t||"object"!=typeof t)return!1;if(Array.isArray(t)){for(let e=0,n=t.length;e<n;e++)if(fe(t[e]))return!0;return!1}if(he(t))return!0;if(t.toJSON&&"function"==typeof t.toJSON&&1===arguments.length)return fe(t.toJSON(),!0);for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e)&&fe(t[e]))return!0;return!1}function pe(t){const e=[],n=t.data,r=t;return r.data=de(n,e),r.attachments=e.length,{packet:r,buffers:e}}function de(t,e){if(!t)return t;if(he(t)){const n={_placeholder:!0,num:e.length};return e.push(t),n}if(Array.isArray(t)){const n=new Array(t.length);for(let r=0;r<t.length;r++)n[r]=de(t[r],e);return n}if("object"==typeof t&&!(t instanceof Date)){const n={};for(const r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=de(t[r],e));return n}return t}function ge(t,e){return t.data=ye(t.data,e),t.attachments=void 0,t}function ye(t,e){if(!t)return t;if(t&&!0===t._placeholder){if("number"==typeof t.num&&t.num>=0&&t.num<e.length)return e[t.num];throw new Error("illegal attachments")}if(Array.isArray(t))for(let n=0;n<t.length;n++)t[n]=ye(t[n],e);else if("object"==typeof t)for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&(t[n]=ye(t[n],e));return t}const me=5;var be,ve;(ve=be||(be={}))[ve.CONNECT=0]="CONNECT",ve[ve.DISCONNECT=1]="DISCONNECT",ve[ve.EVENT=2]="EVENT",ve[ve.ACK=3]="ACK",ve[ve.CONNECT_ERROR=4]="CONNECT_ERROR",ve[ve.BINARY_EVENT=5]="BINARY_EVENT",ve[ve.BINARY_ACK=6]="BINARY_ACK";class we{constructor(t){this.replacer=t}encode(t){return t.type!==be.EVENT&&t.type!==be.ACK||!fe(t)?[this.encodeAsString(t)]:(t.type=t.type===be.EVENT?be.BINARY_EVENT:be.BINARY_ACK,this.encodeAsBinary(t))}encodeAsString(t){let e=""+t.type;return t.type!==be.BINARY_EVENT&&t.type!==be.BINARY_ACK||(e+=t.attachments+"-"),t.nsp&&"/"!==t.nsp&&(e+=t.nsp+","),null!=t.id&&(e+=t.id),null!=t.data&&(e+=JSON.stringify(t.data,this.replacer)),e}encodeAsBinary(t){const e=pe(t),n=this.encodeAsString(e.packet),r=e.buffers;return r.unshift(n),r}}class _e extends A{constructor(t){super(),this.reviver=t}add(t){let e;if("string"==typeof t){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");e=this.decodeString(t),e.type===be.BINARY_EVENT||e.type===be.BINARY_ACK?(this.reconstructor=new Ae(e),0===e.attachments&&super.emitReserved("decoded",e)):super.emitReserved("decoded",e)}else{if(!he(t)&&!t.base64)throw new Error("Unknown type: "+t);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");e=this.reconstructor.takeBinaryData(t),e&&(this.reconstructor=null,super.emitReserved("decoded",e))}}decodeString(t){let e=0;const n={type:Number(t.charAt(0))};if(void 0===be[n.type])throw new Error("unknown packet type "+n.type);if(n.type===be.BINARY_EVENT||n.type===be.BINARY_ACK){const r=e+1;for(;"-"!==t.charAt(++e)&&e!=t.length;);const o=t.substring(r,e);if(o!=Number(o)||"-"!==t.charAt(e))throw new Error("Illegal attachments");n.attachments=Number(o)}if("/"===t.charAt(e+1)){const r=e+1;for(;++e;){if(","===t.charAt(e))break;if(e===t.length)break}n.nsp=t.substring(r,e)}else n.nsp="/";const r=t.charAt(e+1);if(""!==r&&Number(r)==r){const r=e+1;for(;++e;){const n=t.charAt(e);if(null==n||Number(n)!=n){--e;break}if(e===t.length)break}n.id=Number(t.substring(r,e+1))}if(t.charAt(++e)){const r=this.tryParse(t.substr(e));if(!_e.isPayloadValid(n.type,r))throw new Error("invalid payload");n.data=r}return n}tryParse(t){try{return JSON.parse(t,this.reviver)}catch(t){return!1}}static isPayloadValid(t,e){switch(t){case be.CONNECT:return"object"==typeof e;case be.DISCONNECT:return void 0===e;case be.CONNECT_ERROR:return"string"==typeof e||"object"==typeof e;case be.EVENT:case be.BINARY_EVENT:return Array.isArray(e)&&e.length>0;case be.ACK:case be.BINARY_ACK:return Array.isArray(e)}}destroy(){this.reconstructor&&this.reconstructor.finishedReconstruction()}}class Ae{constructor(t){this.packet=t,this.buffers=[],this.reconPack=t}takeBinaryData(t){if(this.buffers.push(t),this.buffers.length===this.reconPack.attachments){const t=ge(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}function Ee(t,e,n){return t.on(e,n),function(){t.off(e,n)}}const Ce=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class Se extends A{constructor(t,e,n){super(),this.connected=!1,this.receiveBuffer=[],this.sendBuffer=[],this.ids=0,this.acks={},this.flags={},this.io=t,this.nsp=e,n&&n.auth&&(this.auth=n.auth),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const t=this.io;this.subs=[Ee(t,"open",this.onopen.bind(this)),Ee(t,"packet",this.onpacket.bind(this)),Ee(t,"error",this.onerror.bind(this)),Ee(t,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected||(this.subEvents(),this.io._reconnecting||this.io.open(),"open"===this.io._readyState&&this.onopen()),this}open(){return this.connect()}send(...t){return t.unshift("message"),this.emit.apply(this,t),this}emit(t,...e){if(Ce.hasOwnProperty(t))throw new Error('"'+t.toString()+'" is a reserved event name');e.unshift(t);const n={type:be.EVENT,data:e,options:{}};if(n.options.compress=!1!==this.flags.compress,"function"==typeof e[e.length-1]){const t=this.ids++,r=e.pop();this._registerAckCallback(t,r),n.id=t}const r=this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable;return this.flags.volatile&&(!r||!this.connected)||(this.connected?(this.notifyOutgoingListeners(n),this.packet(n)):this.sendBuffer.push(n)),this.flags={},this}_registerAckCallback(t,e){const n=this.flags.timeout;if(void 0===n)return void(this.acks[t]=e);const r=this.io.setTimeoutFn((()=>{delete this.acks[t];for(let e=0;e<this.sendBuffer.length;e++)this.sendBuffer[e].id===t&&this.sendBuffer.splice(e,1);e.call(this,new Error("operation has timed out"))}),n);this.acks[t]=(...t)=>{this.io.clearTimeoutFn(r),e.apply(this,[null,...t])}}packet(t){t.nsp=this.nsp,this.io._packet(t)}onopen(){"function"==typeof this.auth?this.auth((t=>{this.packet({type:be.CONNECT,data:t})})):this.packet({type:be.CONNECT,data:this.auth})}onerror(t){this.connected||this.emitReserved("connect_error",t)}onclose(t,e){this.connected=!1,delete this.id,this.emitReserved("disconnect",t,e)}onpacket(t){if(t.nsp===this.nsp)switch(t.type){case be.CONNECT:if(t.data&&t.data.sid){const e=t.data.sid;this.onconnect(e)}else this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case be.EVENT:case be.BINARY_EVENT:this.onevent(t);break;case be.ACK:case be.BINARY_ACK:this.onack(t);break;case be.DISCONNECT:this.ondisconnect();break;case be.CONNECT_ERROR:this.destroy();const e=new Error(t.data.message);e.data=t.data.data,this.emitReserved("connect_error",e)}}onevent(t){const e=t.data||[];null!=t.id&&e.push(this.ack(t.id)),this.connected?this.emitEvent(e):this.receiveBuffer.push(Object.freeze(e))}emitEvent(t){if(this._anyListeners&&this._anyListeners.length){const e=this._anyListeners.slice();for(const n of e)n.apply(this,t)}super.emit.apply(this,t)}ack(t){const e=this;let n=!1;return function(...r){n||(n=!0,e.packet({type:be.ACK,id:t,data:r}))}}onack(t){const e=this.acks[t.id];"function"==typeof e&&(e.apply(this,t.data),delete this.acks[t.id])}onconnect(t){this.id=t,this.connected=!0,this.emitBuffered(),this.emitReserved("connect")}emitBuffered(){this.receiveBuffer.forEach((t=>this.emitEvent(t))),this.receiveBuffer=[],this.sendBuffer.forEach((t=>{this.notifyOutgoingListeners(t),this.packet(t)})),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach((t=>t())),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:be.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(t){return this.flags.compress=t,this}get volatile(){return this.flags.volatile=!0,this}timeout(t){return this.flags.timeout=t,this}onAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(t),this}prependAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(t),this}offAny(t){if(!this._anyListeners)return this;if(t){const e=this._anyListeners;for(let n=0;n<e.length;n++)if(t===e[n])return e.splice(n,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(t),this}prependAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(t),this}offAnyOutgoing(t){if(!this._anyOutgoingListeners)return this;if(t){const e=this._anyOutgoingListeners;for(let n=0;n<e.length;n++)if(t===e[n])return e.splice(n,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(t){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const e=this._anyOutgoingListeners.slice();for(const n of e)n.apply(this,t.data)}}}function Oe(t){t=t||{},this.ms=t.min||100,this.max=t.max||1e4,this.factor=t.factor||2,this.jitter=t.jitter>0&&t.jitter<=1?t.jitter:0,this.attempts=0}Oe.prototype.duration=function(){var t=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),n=Math.floor(e*this.jitter*t);t=0==(1&Math.floor(10*e))?t-n:t+n}return 0|Math.min(t,this.max)},Oe.prototype.reset=function(){this.attempts=0},Oe.prototype.setMin=function(t){this.ms=t},Oe.prototype.setMax=function(t){this.max=t},Oe.prototype.setJitter=function(t){this.jitter=t};class ke extends A{constructor(t,e){var n;super(),this.nsps={},this.subs=[],t&&"object"==typeof t&&(e=t,t=void 0),(e=e||{}).path=e.path||"/socket.io",this.opts=e,k(this,e),this.reconnection(!1!==e.reconnection),this.reconnectionAttempts(e.reconnectionAttempts||1/0),this.reconnectionDelay(e.reconnectionDelay||1e3),this.reconnectionDelayMax(e.reconnectionDelayMax||5e3),this.randomizationFactor(null!==(n=e.randomizationFactor)&&void 0!==n?n:.5),this.backoff=new Oe({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==e.timeout?2e4:e.timeout),this._readyState="closed",this.uri=t;const r=e.parser||se;this.encoder=new r.Encoder,this.decoder=new r.Decoder,this._autoConnect=!1!==e.autoConnect,this._autoConnect&&this.open()}reconnection(t){return arguments.length?(this._reconnection=!!t,this):this._reconnection}reconnectionAttempts(t){return void 0===t?this._reconnectionAttempts:(this._reconnectionAttempts=t,this)}reconnectionDelay(t){var e;return void 0===t?this._reconnectionDelay:(this._reconnectionDelay=t,null===(e=this.backoff)||void 0===e||e.setMin(t),this)}randomizationFactor(t){var e;return void 0===t?this._randomizationFactor:(this._randomizationFactor=t,null===(e=this.backoff)||void 0===e||e.setJitter(t),this)}reconnectionDelayMax(t){var e;return void 0===t?this._reconnectionDelayMax:(this._reconnectionDelayMax=t,null===(e=this.backoff)||void 0===e||e.setMax(t),this)}timeout(t){return arguments.length?(this._timeout=t,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()}open(t){if(~this._readyState.indexOf("open"))return this;this.engine=new oe(this.uri,this.opts);const e=this.engine,n=this;this._readyState="opening",this.skipReconnect=!1;const r=Ee(e,"open",(function(){n.onopen(),t&&t()})),o=Ee(e,"error",(e=>{n.cleanup(),n._readyState="closed",this.emitReserved("error",e),t?t(e):n.maybeReconnectOnOpen()}));if(!1!==this._timeout){const t=this._timeout;0===t&&r();const n=this.setTimeoutFn((()=>{r(),e.close(),e.emit("error",new Error("timeout"))}),t);this.opts.autoUnref&&n.unref(),this.subs.push((function(){clearTimeout(n)}))}return this.subs.push(r),this.subs.push(o),this}connect(t){return this.open(t)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const t=this.engine;this.subs.push(Ee(t,"ping",this.onping.bind(this)),Ee(t,"data",this.ondata.bind(this)),Ee(t,"error",this.onerror.bind(this)),Ee(t,"close",this.onclose.bind(this)),Ee(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(t){try{this.decoder.add(t)}catch(t){this.onclose("parse error")}}ondecoded(t){this.emitReserved("packet",t)}onerror(t){this.emitReserved("error",t)}socket(t,e){let n=this.nsps[t];return n||(n=new Se(this,t,e),this.nsps[t]=n),n}_destroy(t){const e=Object.keys(this.nsps);for(const t of e){if(this.nsps[t].active)return}this._close()}_packet(t){const e=this.encoder.encode(t);for(let n=0;n<e.length;n++)this.engine.write(e[n],t.options)}cleanup(){this.subs.forEach((t=>t())),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close"),this.engine&&this.engine.close()}disconnect(){return this._close()}onclose(t,e){this.cleanup(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",t,e),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const t=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const e=this.backoff.duration();this._reconnecting=!0;const n=this.setTimeoutFn((()=>{t.skipReconnect||(this.emitReserved("reconnect_attempt",t.backoff.attempts),t.skipReconnect||t.open((e=>{e?(t._reconnecting=!1,t.reconnect(),this.emitReserved("reconnect_error",e)):t.onreconnect()})))}),e);this.opts.autoUnref&&n.unref(),this.subs.push((function(){clearTimeout(n)}))}}onreconnect(){const t=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",t)}}const xe={};function Te(t,e){"object"==typeof t&&(e=t,t=void 0);const n=ie(t,(e=e||{}).path||"/socket.io"),r=n.source,o=n.id,i=n.path,s=xe[o]&&i in xe[o].nsps;let a;return e.forceNew||e["force new connection"]||!1===e.multiplex||s?a=new ke(r,e):(xe[o]||(xe[o]=new ke(r,e)),a=xe[o]),n.query&&!e.query&&(e.query=n.queryKey),a.socket(n.path,e)}Object.assign(Te,{Manager:ke,Socket:Se,io:Te,connect:Te});const Re=[{key:"serverURL",type:"string",default:"http://localhost:3000",title:"Python Plugin Server URL",description:"Visit the URL in your browser for agent settings."}];logseq.ready((async function(){if(console.log("Using initial settings schema."),logseq.useSettingsSchema(Re),!await async function(){return!!logseq.settings.serverURL||(console.error("Server URL not configured for Python Plugin."),logseq.App.showMsg("Please configure server URL for Python Plugin.","error"),!1)}())return void console.error("Python Plugin settings are invalid, exiting.");const t=Te(logseq.settings.serverURL,{reconnection:!0,reconnectionDelay:1e3,reconnectionDelayMax:5e3,reconnectionAttempts:1/0,transports:["websocket"]});t.on("connect",(async()=>{console.log("Connected to plugin server."),t.emit("ready"),t.emit("graph",await logseq.App.getCurrentGraph())})),t.on("disconnect",(async()=>{console.log("Disconnected from plugin server."),logseq.useSettingsSchema(Re)})),t.on("useSettingsSchema",(async t=>{const e=t;logseq.useSettingsSchema(e),console.log("SettingsSchema applied:",e)})),t.on("Editor.registerSlashCommand",(async e=>{const n=e.command,r=e.event_name;logseq.Editor.registerSlashCommand(n,(async e=>{t.emit(r)})),console.log("Registered slash command:",n,r)})),t.on("Editor.registerBlockContextMenuItem",(async e=>{const n=e.tag,r=e.event_name;logseq.Editor.registerBlockContextMenuItem(n,(async(...e)=>{console.log("Block context menu item clicked:",n,r,e),t.emit(r)})),console.log("Registered block context menu item:",n,r)})),t.on("Editor.onInputSelectionEnd",(async e=>{const n=e.event_name;logseq.Editor.onInputSelectionEnd((async e=>{console.log("Input selection end:",n,e),t.emit(n,e)})),console.log("Registered input selection end:",n)})),t.on("Editor.getAllPages",(async(t,e)=>{const n=await logseq.Editor.getAllPages();console.log("All pages:",n),e(n)})),t.on("App.onBlockRendererSlotted",(async e=>{const n=e.event_name;logseq.App.onBlockRendererSlotted((async e=>{console.log("Block renderer slotted:",n,e),t.emit(n,e)})),console.log("Registered block renderer slotted:",n)})),t.on("App.onCurrentGraphChanged",(async e=>{const n=e.event_name;logseq.App.onCurrentGraphChanged((async e=>{console.log("Current graph changed:",n,e);const r=await logseq.App.getCurrentGraph();t.emit(n,r)})),console.log("Registered current graph changed:",n)})),t.on("App.onMacroRendererSlotted",(async e=>{const n=e.event_name;logseq.App.onMacroRendererSlotted((async({slot:e,payload:{arguments:arguments}})=>{console.log("Macro renderer slotted:",n,e,arguments),t.emit(n,{slot:e,arguments:arguments})})),console.log("Registered macro renderer slotted:",n)})),t.on("App.onPageHeadActionsSlotted",(async e=>{const n=e.event_name;logseq.App.onPageHeadActionsSlotted((async e=>{console.log("Page head actions slotted:",n,e),t.emit(n,e)})),console.log("Registered page head actions slotted:",n)})),t.on("App.onRouteChanged",(async e=>{const n=e.event_name;logseq.App.onRouteChanged((async e=>{console.log("Route changed:",n,e),t.emit(n,e)})),console.log("Registered route changed:",n)})),t.on("App.onSidebarVisibleChanged",(async e=>{const n=e.event_name;logseq.App.onSidebarVisibleChanged((async e=>{console.log("Sidebar visible changed:",n,e),t.emit(n,e)})),console.log("Registered sidebar visible changed:",n)})),t.on("App.onThemeModeChanged",(async e=>{const n=e.event_name;logseq.App.onThemeModeChanged((async e=>{console.log("Theme mode changed:",n,e),t.emit(n,e)})),console.log("Registered theme mode changed:",n)})),t.on("App.registerCommand",(async e=>{const n=e.type,r=e.desc,o=e.key,i=e.keybinding,s=e.label,a=e.palette,c=e.event_name;logseq.App.registerCommand(n,{desc:r,key:o,keybinding:i,label:s,palette:a},(async e=>{console.log("Command registered:",n,r,o,i,s,a,c,e),t.emit(c,e)})),console.log("Registered command:",n,r,o,i,s,a,c)})),t.on("App.registerCommandPalette",(async e=>{const n=e.key,r=e.keybinding,o=e.label,i=e.event_name;logseq.App.registerCommandPalette({key:n,keybinding:r,label:o},(async e=>{console.log("Command palette registered:",n,r,o,i,e),t.emit(i,e)})),console.log("Registered command palette:",n,r,o,i)})),t.on("DB.datascriptQuery",(async(t,e)=>{const n=t.query,r=t.inputs;console.log("DB.datascriptQuery:",t,n,r);const o=await logseq.DB.datascriptQuery(n);console.log("DB datascript query:",n,r,o),e(o)})),t.onAny((async(t,e,n)=>{var r=e.args,o=Object.assign({},e);if(delete o.args,r.push(o),["connect","disconnect","useSettingsSchema","Editor.registerSlashCommand","Editor.registerBlockContextMenuItem","Editor.onInputSelectionEnd","Editor.getAllPages","App.onBlockRendererSlotted","App.onCurrentGraphChanged","App.onMacroRendererSlotted","App.registerCommand","App.registerCommandPalette","DB.onChanged","DB.onBlockChanged","DB.datascriptQuery"].includes(t))return void console.log("Skipping event:",t);const i=await logseq.App.getCurrentPage();var s;console.log({current_page:i}),console.log("Received event:",t,r);try{console.log("Executing event:",t,r),s=await async function(t,e,n){var r=t.split("."),o=r.pop();console.log("Executing function:",r,o,n,e);for(var i=0;i<r.length;i++)e=e[r[i]];return"AsyncFunction"===e[o].constructor.name?n.length>0?(console.log("Calling async function with args",n),await e[o].apply(e,n)):(console.log("Calling async function"),await e[o].apply(e)):n.length>0?(console.log("Calling function with args",n),e[o].apply(e,n)):(console.log("Calling function"),e[o].apply(e))}(t,logseq,r),console.log("Result:",s),n&&s?(console.log("Calling callback with result:",s),n(s)):n&&(console.log("Calling callback with 'null'"),n("null"))}catch(e){console.error("Error executing function:",t,e),s=e,n&&(console.log("Calling callback with result:",s),n(s))}})),console.log("Plugin: loaded.")})).catch(console.error);